import{r as Z,s as ee,q as te,c as ae,d as se,f as oe,_ as re,a as le,g as ne,h as ie}from"./Layout.vue_vue_type_script_setup_true_lang-BW9AhWFO.js";import{_ as ce,a as ue}from"./index-DZcfcv8L.js";import{c as de}from"./utils-DXrZ82kT.js";import{d as R,c as n,n as U,u as e,G as fe,o as s,b as M,f as v,w as o,i as t,j as f,t as C,g as a,F as w,q as F,r as h,e as me,h as pe,k as ve,S as V,O as I,P as G,al as ye,am as _e,m as be,B as he,v as we,D as ge,E as ke}from"./app-LMLfy6T_.js";import{C as xe}from"./circle-alert-CYnwW9m4.js";import{_ as k}from"./index-BP8NaMnx.js";import{c as Ce,a as $e,_ as Se,b as Fe}from"./CardTitle.vue_vue_type_script_setup_true_lang-G1xx1pv-.js";import{_ as Te}from"./CardDescription.vue_vue_type_script_setup_true_lang-C7_bnbMg.js";import{c as j}from"./createLucideIcon-DAteRrvL.js";import{E as Ee}from"./eye-off-CNRdptsu.js";import{E as Re}from"./eye-DS3jVQrj.js";import{R as Ae}from"./refresh-cw-CO6h026N.js";import{_ as qe}from"./InputError.vue_vue_type_script_setup_true_lang-MJXZgXbE.js";import{d as Me,a as Ve,b as je,c as ze,_ as De}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BSCsZd0f.js";import{v as Be}from"./useForwardExpose-BGfwThGJ.js";import{_ as Ie,a as Le,b as Oe}from"./PinInputSlot.vue_vue_type_script_setup_true_lang-DSDTWqQq.js";import{L as K}from"./loader-circle-DOecIndr.js";import{C as Pe}from"./check-B7CcDjx-.js";import{C as Ne}from"./copy-CEvNZf3o.js";import{_ as H}from"./index-DdRYoR76.js";import{_ as Ke}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dg9vcmqC.js";import"./index-Cs2OOWYa.js";import"./index-C8XGm11V.js";import"./VisuallyHidden-B-IbK-2_.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./VisuallyHiddenInput-C5xV_Z4D.js";import"./house-JRBk0Cia.js";import"./Collection-CHrqpE2f.js";import"./RovingFocusGroup-BtwHaQnx.js";import"./log-out-B30-6VwK.js";import"./clock-DEh5UtGW.js";import"./_plugin-vue_export-helper-Cs5A_DpR.js";import"./users-DURgrSZU.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-bAsAvttd.js";import"./chevron-right-ti3lw4Bb.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=j("LockKeyholeIcon",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=j("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=j("ShieldBanIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=j("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ge=R({__name:"AlertTitle",props:{class:{}},setup(u){const l=u;return(i,p)=>(s(),n("div",{"data-slot":"alert-title",class:U(e(de)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",l.class))},[fe(i.$slots,"default")],2))}}),Je={class:"list-inside list-disc text-sm"},J=R({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(u){const l=u,i=M(()=>Array.from(new Set(l.errors)));return(p,d)=>(s(),v(e(ce),{variant:"destructive"},{default:o(()=>[t(e(xe),{class:"size-4"}),t(e(Ge),null,{default:o(()=>[f(C(u.title),1)]),_:1}),t(e(ue),null,{default:o(()=>[a("ul",Je,[(s(!0),n(w,null,F(i.value,(y,r)=>(s(),n("li",{key:r},C(y),1))),128))])]),_:1})]),_:1}))}}),B=async u=>{const l=await fetch(u,{headers:{Accept:"application/json"}});if(!l.ok)throw new Error(`Failed to fetch: ${l.status}`);return l.json()},E=h([]),$=h(null),S=h(null),q=h([]),We=M(()=>S.value!==null&&$.value!==null),L=()=>{const u=async()=>{try{const{svg:m}=await B(te.url());S.value=m}catch{E.value.push("Failed to fetch QR code"),S.value=null}},l=async()=>{try{const{secretKey:m}=await B(ee.url());$.value=m}catch{E.value.push("Failed to fetch a setup key"),$.value=null}},i=()=>{$.value=null,S.value=null,p()},p=()=>{E.value=[]};return{qrCodeSvg:S,manualSetupKey:$,recoveryCodesList:q,errors:E,hasSetupData:We,clearSetupData:i,clearErrors:p,clearTwoFactorAuthData:()=>{i(),p(),q.value=[]},fetchQrCode:u,fetchSetupKey:l,fetchSetupData:async()=>{try{p(),await Promise.all([u(),l()])}catch{S.value=null,$.value=null}},fetchRecoveryCodes:async()=>{try{p(),q.value=await B(Z.url())}catch{E.value.push("Failed to fetch recovery codes"),q.value=[]}}}},Xe={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},Ye={key:0,class:"mt-6"},Ze={key:1,class:"mt-3 space-y-3"},et={key:0,class:"space-y-2"},tt=R({__name:"TwoFactorRecoveryCodes",setup(u){const{recoveryCodesList:l,fetchRecoveryCodes:i,errors:p}=L(),d=h(!1),y=h(null),r=async()=>{!d.value&&!l.value.length&&await i(),d.value=!d.value,d.value&&(await G(),y.value?.scrollIntoView({behavior:"smooth"}))};return me(async()=>{l.value.length||await i()}),(m,_)=>(s(),v(e(Ce),{class:"w-full"},{default:o(()=>[t(e(Se),null,{default:o(()=>[t(e($e),{class:"flex gap-3"},{default:o(()=>[t(e(He),{class:"size-4"}),_[0]||(_[0]=f("2FA Recovery Codes ",-1))]),_:1}),t(e(Te),null,{default:o(()=>[..._[1]||(_[1]=[f(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),t(e(Fe),null,{default:o(()=>[a("div",Xe,[t(e(k),{onClick:r,class:"w-fit"},{default:o(()=>[(s(),v(ve(d.value?e(Ee):e(Re)),{class:"size-4"})),f(" "+C(d.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),d.value&&e(l).length?(s(),v(e(V),I({key:0},e(ae).form(),{method:"post",options:{preserveScroll:!0},onSuccess:e(i)}),{default:o(({processing:g})=>[t(e(k),{variant:"secondary",type:"submit",disabled:g},{default:o(()=>[t(e(Ae)),_[2]||(_[2]=f(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},16,["onSuccess"])):pe("",!0)]),a("div",{class:U(["relative overflow-hidden transition-all duration-300",d.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(p)?.length?(s(),n("div",Ye,[t(J,{errors:e(p)},null,8,["errors"])])):(s(),n("div",Ze,[a("div",{ref_key:"recoveryCodeSectionRef",ref:y,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(l).length?(s(!0),n(w,{key:1},F(e(l),(g,x)=>(s(),n("div",{key:x},C(g),1))),128)):(s(),n("div",et,[(s(),n(w,null,F(8,g=>a("div",{key:g,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),_[3]||(_[3]=a("p",{class:"text-xs text-muted-foreground select-none"},[f(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),a("span",{class:"font-bold"},"Regenerate Codes"),f(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),at={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},st={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},ot={class:"absolute inset-0 grid grid-cols-5 opacity-50"},rt={class:"absolute inset-0 grid grid-rows-5 opacity-50"},lt={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},nt={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},it={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},ct={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},ut={key:1,class:"relative z-10 overflow-hidden border p-5"},dt=["innerHTML"],ft={class:"flex w-full items-center space-x-5"},mt={class:"flex w-full items-center justify-center space-x-2"},pt={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},vt={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},yt=["value"],_t=["value"],bt={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},ht={class:"flex w-full items-center space-x-5"},wt=R({__name:"TwoFactorSetupModal",props:ye({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(u){const l=u,i=_e(u,"isOpen"),{copy:p,copied:d}=Be(),{qrCodeSvg:y,manualSetupKey:r,clearSetupData:m,fetchSetupData:_,errors:g}=L(),x=h(!1),T=h([]),O=M(()=>T.value.join("")),P=h(null),z=M(()=>l.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:x.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),W=()=>{if(l.requiresConfirmation){x.value=!0,G(()=>{P.value?.querySelector("input")?.focus()});return}m(),i.value=!1},X=()=>{l.twoFactorEnabled&&m(),x.value=!1,T.value=[]};return be(()=>i.value,async N=>{if(!N){X();return}y.value||await _()}),(N,c)=>(s(),v(e(Me),{open:i.value,"onUpdate:open":c[5]||(c[5]=b=>i.value=b)},{default:o(()=>[t(e(De),{class:"sm:max-w-md"},{default:o(()=>[t(e(Ve),{class:"flex items-center justify-center"},{default:o(()=>[a("div",at,[a("div",st,[a("div",ot,[(s(),n(w,null,F(5,b=>a("div",{key:`col-${b}`,class:"border-r border-border last:border-r-0"})),64))]),a("div",rt,[(s(),n(w,null,F(5,b=>a("div",{key:`row-${b}`,class:"border-b border-border last:border-b-0"})),64))]),t(e(Qe),{class:"relative z-20 size-6 text-foreground"})])]),t(e(je),null,{default:o(()=>[f(C(z.value.title),1)]),_:1}),t(e(ze),{class:"text-center"},{default:o(()=>[f(C(z.value.description),1)]),_:1})]),_:1}),a("div",lt,[x.value?(s(),v(e(V),I({key:1},e(se).form(),{"reset-on-error":"",onFinish:c[3]||(c[3]=b=>T.value=[]),onSuccess:c[4]||(c[4]=b=>i.value=!1)}),{default:o(({errors:b,processing:D})=>[a("input",{type:"hidden",name:"code",value:O.value},null,8,_t),a("div",{ref_key:"pinInputContainerRef",ref:P,class:"relative w-full space-y-3"},[a("div",bt,[t(e(Ie),{id:"otp",placeholder:"○",modelValue:T.value,"onUpdate:modelValue":c[1]||(c[1]=A=>T.value=A),type:"number",otp:""},{default:o(()=>[t(e(Le),null,{default:o(()=>[(s(),n(w,null,F(6,(A,Y)=>t(e(Oe),{autofocus:"",key:A,index:Y,disabled:D},null,8,["index","disabled"])),64))]),_:2},1024)]),_:2},1032,["modelValue"]),t(qe,{message:b?.confirmTwoFactorAuthentication?.code},null,8,["message"])]),a("div",ht,[t(e(k),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:c[2]||(c[2]=A=>x.value=!1),disabled:D},{default:o(()=>[...c[7]||(c[7]=[f(" Back ",-1)])]),_:1},8,["disabled"]),t(e(k),{type:"submit",class:"w-auto flex-1",disabled:D||O.value.length<6},{default:o(()=>[...c[8]||(c[8]=[f(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},16)):(s(),n(w,{key:0},[e(g)?.length?(s(),v(J,{key:0,errors:e(g)},null,8,["errors"])):(s(),n(w,{key:1},[a("div",nt,[a("div",it,[e(y)?(s(),n("div",ut,[a("div",{innerHTML:e(y),class:"flex aspect-square size-full items-center justify-center"},null,8,dt)])):(s(),n("div",ct,[t(e(K),{class:"size-6 animate-spin"})]))])]),a("div",ft,[t(e(k),{class:"w-full",onClick:W},{default:o(()=>[f(C(z.value.buttonText),1)]),_:1})]),c[6]||(c[6]=a("div",{class:"relative flex w-full items-center justify-center"},[a("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),a("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),a("div",mt,[a("div",pt,[e(r)?(s(),n(w,{key:1},[a("input",{type:"text",readonly:"",value:e(r),class:"h-full w-full bg-background p-3 text-foreground"},null,8,yt),a("button",{onClick:c[0]||(c[0]=b=>e(p)(e(r)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(d)?(s(),v(e(Pe),{key:0,class:"w-4 text-green-500"})):(s(),v(e(Ne),{key:1,class:"w-4"}))])],64)):(s(),n("div",vt,[t(e(K),{class:"size-4 animate-spin"})]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),gt={class:"space-y-6"},kt={key:0,class:"flex flex-col items-start justify-start space-y-4"},xt={key:1,class:"flex flex-col items-start justify-start space-y-4"},Ct={class:"relative inline"},la=R({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(u){const l=[{title:"Autenticación de dos factores",href:oe.url()}],{hasSetupData:i,clearTwoFactorAuthData:p}=L(),d=h(!1);return he(()=>{p()}),(y,r)=>(s(),v(Ke,{breadcrumbs:l},{default:o(()=>[t(e(we),{title:"Autenticación de dos factores"}),t(re,null,{default:o(()=>[a("div",gt,[t(le,{title:"Autenticación de dos factores",description:"Administra tu configuración de autenticación de dos factores"}),u.twoFactorEnabled?(s(),n("div",xt,[t(e(H),{variant:"default"},{default:o(()=>[...r[7]||(r[7]=[f("Habilitado",-1)])]),_:1}),r[9]||(r[9]=a("p",{class:"text-muted-foreground"}," Con la autenticación de dos factores habilitada, se te pedirá un PIN seguro y aleatorio durante el inicio de sesión, que puedes obtener de la aplicación compatible con TOTP en tu teléfono. ",-1)),t(tt),a("div",Ct,[t(e(V),ge(ke(e(ie).form())),{default:o(({processing:m})=>[t(e(k),{variant:"destructive",type:"submit",disabled:m},{default:o(()=>[t(e(Ue)),r[8]||(r[8]=f(" Deshabilitar 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16)])])):(s(),n("div",kt,[t(e(H),{variant:"destructive"},{default:o(()=>[...r[3]||(r[3]=[f("Deshabilitado",-1)])]),_:1}),r[6]||(r[6]=a("p",{class:"text-muted-foreground"}," Cuando habilitas la autenticación de dos factores, se te pedirá un PIN seguro durante el inicio de sesión. Este PIN se puede obtener de una aplicación compatible con TOTP en tu teléfono. ",-1)),a("div",null,[e(i)?(s(),v(e(k),{key:0,onClick:r[0]||(r[0]=m=>d.value=!0)},{default:o(()=>[t(e(Q)),r[4]||(r[4]=f("Continuar configuración ",-1))]),_:1})):(s(),v(e(V),I({key:1},e(ne).form(),{onSuccess:r[1]||(r[1]=m=>d.value=!0)}),{default:o(({processing:m})=>[t(e(k),{type:"submit",disabled:m},{default:o(()=>[t(e(Q)),r[5]||(r[5]=f("Habilitar 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16))])])),t(wt,{isOpen:d.value,"onUpdate:isOpen":r[2]||(r[2]=m=>d.value=m),requiresConfirmation:u.requiresConfirmation,twoFactorEnabled:u.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{la as default};
