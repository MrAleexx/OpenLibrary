import{d as te,K as fe,c as u,g as e,h as w,i as o,u as s,t as d,w as m,y as M,j as x,l as F,f as A,k as J,A as pe,F as L,q as O,o as l,r as $,b as Z,v as ge,H as Q,I as xe,L as ee,n as N,s as z}from"./app-2QXCfeMG.js";import{F as P,d as se,e as oe,f as re,g as C,h as G,X as B,_ as ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-D0s4Pvhb.js";import{_ as ae}from"./index-ByX7PKqW.js";import{c as U}from"./createLucideIcon-CganvotL.js";import{E as ne}from"./ellipsis-CAdr-u2b.js";import{E as I}from"./eye-tKbU2OYl.js";import{H as q}from"./history-dyi7Ka4q.js";import{S as R}from"./square-pen-JCw1GlaG.js";import{E as W}from"./eye-off-DdBw1_bM.js";import{T as de}from"./trash-2-CPhtcKjV.js";import{_ as be,B as ye}from"./_plugin-vue_export-helper-D6Za-jf_.js";import{P as he}from"./plus-C6ijddus.js";import{S as _e}from"./search-DEpn_CFc.js";import{F as we}from"./filter-C3BNhBy1.js";import"./utils-BtbbqlUx.js";import"./useForwardExpose-WdC8WNUR.js";import"./VisuallyHidden-BVvg5NBU.js";import"./house-Jt9P1-Sj.js";import"./Collection-p-5Ft2RQ.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-Bsye0hv5.js";import"./index-Cs2OOWYa.js";import"./log-out-BvlH2FDg.js";import"./AppLogoPng.vue_vue_type_script_setup_true_lang-DV5UP9ty.js";import"./clock-7_ft3SL5.js";import"./users-BtwuLIeb.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DAJcy_Cp.js";import"./chevron-right-CD5--JLw.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=U("FolderOpenIcon",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=U("GripVerticalIcon",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=U("ListTreeIcon",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=U("TableIcon",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),De={class:"category-node"},$e={class:"flex flex-1 items-center gap-3"},Te={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10"},Ie={class:"min-w-0 flex-1"},je={class:"flex items-center gap-2"},Se={class:"font-semibold text-foreground"},Ee={class:"text-xs text-muted-foreground"},Ve={key:0,class:"truncate text-sm text-muted-foreground"},He={class:"flex items-center gap-2"},Le={class:"rounded bg-muted px-2 py-1 text-xs text-foreground"},Ae={key:0,class:"children-container"},Me=te({__name:"CategoryTreeNode",props:{category:{},depth:{}},emits:["drag-start","drop-before","drop-after","drop-inside","toggle-status","view-details","view-history","delete-category"],setup(i,{emit:j}){const g=j,y=(c,a)=>{g("drag-start",c,a)},h=(c,a)=>{g("drop-before",c,a)},_=(c,a)=>{g("drop-after",c,a)},D=(c,a)=>{g("drop-inside",c,a)},f=c=>{g("toggle-status",c)},S=c=>{g("view-details",c)},E=c=>{g("view-history",c)},V=c=>{g("delete-category",c)},T=c=>{c.preventDefault(),c.dataTransfer&&(c.dataTransfer.dropEffect="move")};return(c,a)=>{const H=fe("CategoryTreeNode",!0);return l(),u("div",De,[e("div",{class:"drop-zone drop-zone-before h-2 bg-transparent transition-colors hover:bg-primary/20",onDragover:T,onDrop:a[0]||(a[0]=v=>h(v,i.category))},null,32),e("div",{class:"mb-1 flex cursor-move items-center justify-between rounded-lg border border-border p-4 transition-colors hover:bg-accent/50",draggable:"true",onDragstart:a[5]||(a[5]=v=>y(v,i.category)),onDragover:T,onDrop:a[6]||(a[6]=v=>D(v,i.category)),style:pe({marginLeft:i.depth*20+"px"})},[e("div",$e,[o(s(le),{class:"h-4 w-4 cursor-move text-muted-foreground"}),e("div",Te,[o(s(P),{class:"h-4 w-4 text-primary"})]),e("div",Ie,[e("div",je,[e("span",Se,d(i.category.name),1),e("span",Ee,"("+d(i.category.books_count)+" libros)",1)]),i.category.description?(l(),u("p",Ve,d(i.category.description),1)):w("",!0)])]),e("div",He,[e("span",Le," Orden: "+d(i.category.sort_order),1),o(s(se),null,{default:m(()=>[o(s(oe),{"as-child":""},{default:m(()=>[o(s(ae),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0 opacity-50 transition-opacity duration-200 group-hover:opacity-100"},{default:m(()=>[o(s(ne),{class:"h-4 w-4"})]),_:1})]),_:1}),o(s(re),{align:"end",class:"w-48"},{default:m(()=>[o(s(C),{onClick:a[1]||(a[1]=M(v=>S(i.category),["stop"])),class:"cursor-pointer"},{default:m(()=>[o(s(I),{class:"mr-2 h-4 w-4 text-blue-500"}),a[16]||(a[16]=x(" Ver detalles ",-1))]),_:1}),o(s(C),{onClick:a[2]||(a[2]=M(v=>E(i.category),["stop"])),class:"cursor-pointer"},{default:m(()=>[o(s(q),{class:"mr-2 h-4 w-4 text-purple-500"}),a[17]||(a[17]=x(" Historial ",-1))]),_:1}),o(s(C),{"as-child":""},{default:m(()=>[o(s(F),{href:`/admin/categories/${i.category.id}/edit`,class:"flex cursor-pointer items-center text-foreground"},{default:m(()=>[o(s(R),{class:"mr-2 h-4 w-4 text-emerald-500"}),a[18]||(a[18]=x(" Editar ",-1))]),_:1},8,["href"])]),_:1}),o(s(G)),o(s(C),{onClick:a[3]||(a[3]=M(v=>f(i.category),["stop"])),class:"cursor-pointer"},{default:m(()=>[(l(),A(J(i.category.is_active?s(W):s(I)),{class:"mr-2 h-4 w-4 text-orange-500"})),x(" "+d(i.category.is_active?"Desactivar":"Activar"),1)]),_:1}),o(s(G)),o(s(C),{onClick:a[4]||(a[4]=M(v=>V(i.category),["stop"])),class:"cursor-pointer text-destructive focus:text-destructive",disabled:i.category.books_count>0||i.category.children&&i.category.children.length>0},{default:m(()=>[o(s(de),{class:"mr-2 h-4 w-4"}),a[19]||(a[19]=x(" Eliminar ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])],36),e("div",{class:"drop-zone drop-zone-after h-2 bg-transparent transition-colors hover:bg-primary/20",onDragover:T,onDrop:a[7]||(a[7]=v=>_(v,i.category))},null,32),i.category.children&&i.category.children.length>0?(l(),u("div",Ae,[(l(!0),u(L,null,O(i.category.children,v=>(l(),A(H,{key:v.id,category:v,depth:i.depth+1,onDragStart:a[8]||(a[8]=(p,k)=>g("drag-start",p,k)),onDropBefore:a[9]||(a[9]=(p,k)=>g("drop-before",p,k)),onDropAfter:a[10]||(a[10]=(p,k)=>g("drop-after",p,k)),onDropInside:a[11]||(a[11]=(p,k)=>g("drop-inside",p,k)),onToggleStatus:a[12]||(a[12]=p=>g("toggle-status",p)),onViewDetails:a[13]||(a[13]=p=>g("view-details",p)),onViewHistory:a[14]||(a[14]=p=>g("view-history",p)),onDeleteCategory:a[15]||(a[15]=p=>g("delete-category",p))},null,8,["category","depth"]))),128))])):w("",!0)])}}}),Ne=be(Me,[["__scopeId","data-v-a0c127fc"]]),ze={class:"space-y-6 p-6"},Be={class:"flex items-center justify-between"},Fe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Oe={class:"animate__animated animate__fadeIn rounded-xl border border-border bg-card p-6 shadow-sm transition-all duration-200 hover:shadow-md"},Pe={class:"flex items-center justify-between"},qe={class:"mt-1 text-2xl font-bold text-foreground"},Ge={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10"},Ue={class:"animate__animated animate__fadeIn animate__delay-100ms rounded-xl border border-border bg-card p-6 shadow-sm transition-all duration-200 hover:shadow-md"},Ke={class:"flex items-center justify-between"},Qe={class:"mt-1 text-2xl font-bold text-foreground"},Xe={class:"bg-success/10 flex h-12 w-12 items-center justify-center rounded-lg"},Je={class:"animate__animated animate__fadeIn animate__delay-200ms rounded-xl border border-border bg-card p-6 shadow-sm transition-all duration-200 hover:shadow-md"},Re={class:"flex items-center justify-between"},We={class:"mt-1 text-2xl font-bold text-foreground"},Ye={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-secondary/10"},Ze={class:"animate__animated animate__fadeIn animate__delay-300ms rounded-xl border border-border bg-card p-6 shadow-sm transition-all duration-200 hover:shadow-md"},et={class:"flex items-center justify-between"},tt={class:"mt-1 text-2xl font-bold text-foreground"},st={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10"},ot={class:"animate__animated animate__fadeIn animate__delay-400ms rounded-xl border border-border bg-card p-4 shadow-sm"},rt={class:"flex flex-col items-start justify-between gap-4 lg:flex-row lg:items-center"},at={class:"w-full flex-1 lg:max-w-md"},nt={class:"relative"},dt={class:"flex flex-wrap gap-2"},lt={class:"flex rounded-lg border border-border p-1"},it={key:0,class:"mt-3 border-t border-border pt-3"},ut={class:"flex items-center gap-2 text-sm text-muted-foreground"},ct={key:0,class:"rounded bg-primary/10 px-2 py-1 text-xs text-primary"},mt={key:1,class:"rounded bg-secondary/10 px-2 py-1 text-xs text-secondary"},ft={key:2,class:"rounded bg-primary/10 px-2 py-1 text-xs text-primary"},pt={class:"text-sm text-muted-foreground"},gt={key:0,class:"animate__animated animate__fadeIn animate__delay-500ms rounded-xl border border-border bg-card shadow-lg"},xt={class:"p-6"},vt={key:0,class:"py-12 text-center"},bt={key:1,class:"overflow-x-auto"},yt={class:"w-full whitespace-nowrap"},ht=["onDragstart","onDrop"],_t={class:"px-4 py-4"},wt={class:"flex items-center gap-3"},kt={class:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10"},Ct={class:"font-semibold text-foreground"},Dt={key:0,class:"max-w-xs truncate text-sm text-muted-foreground"},$t={class:"px-4 py-4 font-mono text-sm text-muted-foreground"},Tt={class:"px-4 py-4"},It={key:0,class:"rounded bg-secondary/10 px-2 py-1 text-sm text-secondary"},jt={key:1,class:"text-sm text-muted-foreground"},St={class:"px-4 py-4"},Et={class:"rounded-full bg-primary/10 px-3 py-1 text-sm font-medium text-primary"},Vt={class:"px-4 py-4"},Ht={key:0,class:"rounded-full bg-secondary/10 px-3 py-1 text-sm font-medium text-secondary"},Lt={key:1,class:"text-sm text-muted-foreground"},At={class:"px-4 py-4"},Mt=["onClick"],Nt={class:"px-4 py-4"},zt={class:"rounded bg-muted px-2 py-1 font-mono text-sm text-foreground"},Bt={class:"px-4 py-4"},Ft={key:1,class:"animate__animated animate__fadeIn animate__delay-500ms rounded-xl border border-border bg-card p-6 shadow-lg"},Ot={key:0,class:"py-12 text-center"},Pt={key:1,class:"space-y-2"},qt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},Gt={class:"max-h-[90vh] w-full max-w-md overflow-y-auto rounded-xl border border-border bg-card p-6"},Ut={class:"mb-4 flex items-center justify-between"},Kt={class:"space-y-4"},Qt={class:"flex items-center gap-3 rounded-lg bg-primary/5 p-3"},Xt={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10"},Jt={class:"font-semibold text-foreground"},Rt={class:"text-sm text-muted-foreground"},Wt={class:"grid grid-cols-2 gap-4 text-sm"},Yt={class:"ml-2 font-medium"},Zt={class:"ml-2 font-medium"},es={class:"ml-2 font-medium"},ts={key:0},ss={class:"text-foreground"},os={class:"grid grid-cols-2 gap-4 text-sm"},rs={class:"ml-2 font-medium"},as={class:"ml-2 font-medium"},ns={class:"flex gap-2 border-t border-border pt-4"},ds={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},ls={class:"max-h-[90vh] w-full max-w-2xl overflow-y-auto rounded-xl border border-border bg-card p-6"},is={class:"mb-4 flex items-center justify-between"},us={class:"text-xl font-bold text-foreground"},cs={key:0,class:"py-8 text-center"},ms={key:1,class:"space-y-3"},fs={class:"flex-1"},ps={class:"font-medium text-foreground"},gs={class:"text-sm text-muted-foreground"},Gs=te({__name:"Index",props:{categories:{},viewType:{}},setup(i){const j=i,g=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Categorías",href:"/admin/categories"}],y=$(""),h=$("all"),_=$("all"),D=$(j.viewType||"table"),f=$(null),S=$(!1),E=$(!1),V=$([]),T=Z(()=>{let n=j.categories;return y.value&&(n=n.filter(t=>t.name.toLowerCase().includes(y.value.toLowerCase())||t.slug.toLowerCase().includes(y.value.toLowerCase())||t.description&&t.description.toLowerCase().includes(y.value.toLowerCase()))),h.value!=="all"&&(n=n.filter(t=>h.value==="active"?t.is_active:!t.is_active)),_.value!=="all"&&(n=n.filter(t=>_.value==="parent"?t.parent_id===null:t.parent_id!==null)),n}),c=Z(()=>j.categories.filter(n=>n.parent_id===null).sort((n,t)=>n.sort_order-t.sort_order)),a=n=>{confirm(`¿Estás seguro de que quieres eliminar la categoría "${n.name}"?`)&&z.delete(`/admin/categories/${n.id}`)},H=n=>{z.patch(`/admin/categories/${n.id}/toggle-status`)},v=n=>{f.value=n,S.value=!0},p=async n=>{f.value=n,V.value=[{id:1,action:"created",description:"Categoría creada",user:{name:"Administrador"},created_at:"2024-01-15 10:30:00"}],E.value=!0},k=(n,t)=>{n.dataTransfer&&(n.dataTransfer.setData("text/plain",t.id.toString()),n.dataTransfer.effectAllowed="move")},ie=n=>{n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move")},K=async(n,t,r)=>{n.preventDefault();const b=n.dataTransfer?.getData("text/plain");if(b&&!(r==="inside"&&parseInt(b)===t.id))try{await z.patch("/admin/categories/reorder",{draggedId:parseInt(b),targetId:t.id,position:r,newParentId:r==="inside"?t.id:t.parent_id}),z.reload()}catch(me){console.error("Error reordenando categoría:",me),alert("Error al reordenar la categoría")}},ue=(n,t)=>K(n,t,"before"),ce=(n,t)=>K(n,t,"after"),Y=(n,t)=>K(n,t,"inside");return(n,t)=>(l(),u(L,null,[o(s(ge),{title:"Gestión de Categorías"}),o(ve,{breadcrumbs:g},{default:m(()=>[e("div",ze,[e("div",Be,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-3xl font-bold text-foreground"}," Gestión de Categorías "),e("p",{class:"mt-2 text-muted-foreground"}," Administra las categorías y subcategorías de tu biblioteca ")],-1)),o(s(F),{href:"/admin/categories/create",class:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground shadow-lg shadow-primary/25 transition-colors hover:bg-primary/90"},{default:m(()=>[o(s(he),{class:"h-4 w-4"}),t[10]||(t[10]=x(" Nueva Categoría ",-1))]),_:1})]),e("div",Fe,[e("div",Oe,[e("div",Pe,[e("div",null,[t[12]||(t[12]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Total Categorías ",-1)),e("p",qe,d(i.categories.length),1)]),e("div",Ge,[o(s(P),{class:"h-6 w-6 text-primary"})])])]),e("div",Ue,[e("div",Ke,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Categorías Activas ",-1)),e("p",Qe,d(i.categories.filter(r=>r.is_active).length),1)]),e("div",Xe,[o(s(I),{class:"text-success h-6 w-6"})])])]),e("div",Je,[e("div",Re,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Subcategorías ",-1)),e("p",We,d(i.categories.filter(r=>r.parent_id!==null).length),1)]),e("div",Ye,[o(s(X),{class:"h-6 w-6 text-secondary"})])])]),e("div",Ze,[e("div",et,[e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Promedio Libros ",-1)),e("p",tt,d(Math.round(i.categories.reduce((r,b)=>r+b.books_count,0)/i.categories.length)||0),1)]),e("div",st,[o(s(ye),{class:"h-6 w-6 text-blue-500"})])])])]),e("div",ot,[e("div",rt,[e("div",at,[e("div",nt,[o(s(_e),{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"}),Q(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>y.value=r),type:"text",placeholder:"Buscar categorías por nombre, slug o descripción...",class:"w-full rounded-lg border border-border bg-background py-2 pr-4 pl-10 text-foreground focus:border-transparent focus:ring-2 focus:ring-primary focus:outline-none"},null,512),[[xe,y.value]])])]),e("div",dt,[Q(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>h.value=r),class:"rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground"},[...t[16]||(t[16]=[e("option",{value:"all"},"Todos los estados",-1),e("option",{value:"active"},"Solo activas",-1),e("option",{value:"inactive"},"Solo inactivas",-1)])],512),[[ee,h.value]]),Q(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>_.value=r),class:"rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground"},[...t[17]||(t[17]=[e("option",{value:"all"},"Todos los tipos",-1),e("option",{value:"parent"},"Solo principales",-1),e("option",{value:"child"},"Solo subcategorías",-1)])],512),[[ee,_.value]])]),e("div",lt,[e("button",{onClick:t[3]||(t[3]=r=>D.value="table"),class:N([D.value==="table"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground","flex items-center gap-2 rounded px-3 py-1 text-sm transition-colors"])},[o(s(Ce),{class:"h-4 w-4"}),t[18]||(t[18]=x(" Tabla ",-1))],2),e("button",{onClick:t[4]||(t[4]=r=>D.value="tree"),class:N([D.value==="tree"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground","flex items-center gap-2 rounded px-3 py-1 text-sm transition-colors"])},[o(s(ke),{class:"h-4 w-4"}),t[19]||(t[19]=x(" Árbol ",-1))],2)])]),y.value||h.value!=="all"||_.value!=="all"?(l(),u("div",it,[e("div",ut,[o(s(we),{class:"h-4 w-4"}),t[21]||(t[21]=e("span",null,"Filtros activos:",-1)),y.value?(l(),u("span",ct,' Búsqueda: "'+d(y.value)+'" ',1)):w("",!0),h.value!=="all"?(l(),u("span",mt," Estado: "+d(h.value==="active"?"Activas":"Inactivas"),1)):w("",!0),_.value!=="all"?(l(),u("span",ft," Tipo: "+d(_.value==="parent"?"Principales":"Subcategorías"),1)):w("",!0),e("button",{onClick:t[5]||(t[5]=r=>{y.value="",h.value="all",_.value="all"}),class:"flex items-center gap-1 text-xs text-destructive hover:text-destructive/80"},[o(s(B),{class:"h-3 w-3"}),t[20]||(t[20]=x(" Limpiar ",-1))])])])):w("",!0)]),e("div",pt," Mostrando "+d(T.value.length)+" de "+d(i.categories.length)+" categorías ",1),D.value==="table"?(l(),u("div",gt,[e("div",xt,[T.value.length===0?(l(),u("div",vt,[o(s(X),{class:"mx-auto mb-4 h-16 w-16 text-muted-foreground"}),t[23]||(t[23]=e("p",{class:"mb-2 text-lg text-muted-foreground"}," No se encontraron categorías ",-1)),t[24]||(t[24]=e("p",{class:"mb-6 text-muted-foreground"}," Intenta ajustar tus filtros de búsqueda ",-1)),e("button",{onClick:t[6]||(t[6]=r=>{y.value="",h.value="all",_.value="all"}),class:"inline-flex items-center gap-2 rounded-lg bg-primary px-6 py-3 text-primary-foreground transition-colors hover:bg-primary/90"},[o(s(B),{class:"h-4 w-4"}),t[22]||(t[22]=x(" Limpiar filtros ",-1))])])):(l(),u("div",bt,[e("table",yt,[t[29]||(t[29]=e("thead",null,[e("tr",{class:"border-b border-border"},[e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Nombre "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Slug "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Categoría Padre "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Libros "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Subcategorías "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Estado "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Orden "),e("th",{class:"px-4 py-4 text-left font-semibold text-foreground"}," Acciones ")])],-1)),e("tbody",null,[(l(!0),u(L,null,O(T.value,r=>(l(),u("tr",{key:r.id,class:"group border-b border-border transition-colors hover:bg-muted/50",draggable:"true",onDragstart:b=>k(b,r),onDragover:ie,onDrop:b=>Y(b,r)},[e("td",_t,[e("div",wt,[o(s(le),{class:"h-4 w-4 cursor-move text-muted-foreground"}),e("div",kt,[o(s(P),{class:"h-5 w-5 text-primary"})]),e("div",null,[e("p",Ct,d(r.name),1),r.description?(l(),u("p",Dt,d(r.description),1)):w("",!0)])])]),e("td",$t,d(r.slug),1),e("td",Tt,[r.parent_name?(l(),u("span",It,d(r.parent_name),1)):(l(),u("span",jt,"—"))]),e("td",St,[e("span",Et,d(r.books_count)+" libros ",1)]),e("td",Vt,[r.children_count>0?(l(),u("span",Ht,d(r.children_count)+" sub ",1)):(l(),u("span",Lt,"—"))]),e("td",At,[e("button",{onClick:b=>H(r),class:N(["flex items-center gap-2 rounded-full px-3 py-1 text-sm font-medium transition-colors",r.is_active?"bg-success/10 text-success hover:bg-success/20":"bg-muted text-muted-foreground hover:bg-muted/80"])},[(l(),A(J(r.is_active?s(I):s(W)),{class:"h-4 w-4"})),x(" "+d(r.is_active?"Activa":"Inactiva"),1)],10,Mt)]),e("td",Nt,[e("span",zt,d(r.sort_order),1)]),e("td",Bt,[o(s(se),null,{default:m(()=>[o(s(oe),{"as-child":""},{default:m(()=>[o(s(ae),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0 opacity-50 transition-opacity duration-200 group-hover:opacity-100"},{default:m(()=>[o(s(ne),{class:"h-4 w-4"})]),_:1})]),_:1}),o(s(re),{align:"end",class:"w-48"},{default:m(()=>[o(s(C),{onClick:b=>v(r),class:"cursor-pointer"},{default:m(()=>[o(s(I),{class:"mr-2 h-4 w-4 text-blue-500"}),t[25]||(t[25]=x(" Ver detalles ",-1))]),_:1},8,["onClick"]),o(s(C),{onClick:b=>p(r),class:"cursor-pointer"},{default:m(()=>[o(s(q),{class:"mr-2 h-4 w-4 text-purple-500"}),t[26]||(t[26]=x(" Historial ",-1))]),_:1},8,["onClick"]),o(s(C),{"as-child":""},{default:m(()=>[o(s(F),{href:`/admin/categories/${r.id}/edit`,class:"flex cursor-pointer items-center text-foreground"},{default:m(()=>[o(s(R),{class:"mr-2 h-4 w-4 text-emerald-500"}),t[27]||(t[27]=x(" Editar ",-1))]),_:1},8,["href"])]),_:2},1024),o(s(G)),o(s(C),{onClick:b=>H(r),class:"cursor-pointer"},{default:m(()=>[(l(),A(J(r.is_active?s(W):s(I)),{class:"mr-2 h-4 w-4 text-orange-500"})),x(" "+d(r.is_active?"Desactivar":"Activar"),1)]),_:2},1032,["onClick"]),o(s(G)),o(s(C),{onClick:b=>a(r),class:"cursor-pointer text-destructive focus:text-destructive",disabled:r.books_count>0||r.children_count>0},{default:m(()=>[o(s(de),{class:"mr-2 h-4 w-4"}),t[28]||(t[28]=x(" Eliminar ",-1))]),_:1},8,["onClick","disabled"])]),_:2},1024)]),_:2},1024)])],40,ht))),128))])])]))])])):D.value==="tree"?(l(),u("div",Ft,[c.value.length===0?(l(),u("div",Ot,[o(s(X),{class:"mx-auto mb-4 h-16 w-16 text-muted-foreground"}),t[30]||(t[30]=e("p",{class:"mb-2 text-lg text-muted-foreground"}," No se encontraron categorías ",-1))])):(l(),u("div",Pt,[(l(!0),u(L,null,O(c.value,r=>(l(),A(Ne,{key:r.id,category:r,depth:0,onDragStart:k,onDropBefore:ue,onDropAfter:ce,onDropInside:Y,onToggleStatus:H,onViewDetails:v,onViewHistory:p,onDeleteCategory:a},null,8,["category"]))),128))]))])):w("",!0)]),S.value&&f.value?(l(),u("div",qt,[e("div",Gt,[e("div",Ut,[t[31]||(t[31]=e("h3",{class:"text-xl font-bold text-foreground"}," Detalles de Categoría ",-1)),e("button",{onClick:t[7]||(t[7]=r=>S.value=!1),class:"rounded p-1 transition-colors hover:bg-accent"},[o(s(B),{class:"h-5 w-5"})])]),e("div",Kt,[e("div",Qt,[e("div",Xt,[o(s(P),{class:"h-6 w-6 text-primary"})]),e("div",null,[e("h4",Jt,d(f.value.name),1),e("p",Rt,d(f.value.slug),1)])]),e("div",Wt,[e("div",null,[t[32]||(t[32]=e("span",{class:"text-muted-foreground"},"Estado:",-1)),e("span",{class:N([f.value.is_active?"text-success":"text-warning","ml-2 font-medium"])},d(f.value.is_active?"Activa":"Inactiva"),3)]),e("div",null,[t[33]||(t[33]=e("span",{class:"text-muted-foreground"},"Orden:",-1)),e("span",Yt,d(f.value.sort_order),1)]),e("div",null,[t[34]||(t[34]=e("span",{class:"text-muted-foreground"},"Libros:",-1)),e("span",Zt,d(f.value.books_count),1)]),e("div",null,[t[35]||(t[35]=e("span",{class:"text-muted-foreground"},"Subcategorías:",-1)),e("span",es,d(f.value.children_count),1)])]),f.value.description?(l(),u("div",ts,[t[36]||(t[36]=e("span",{class:"mb-1 block text-sm text-muted-foreground"},"Descripción:",-1)),e("p",ss,d(f.value.description),1)])):w("",!0),e("div",os,[e("div",null,[t[37]||(t[37]=e("span",{class:"text-muted-foreground"},"Creado:",-1)),e("span",rs,d(f.value.created_at),1)]),e("div",null,[t[38]||(t[38]=e("span",{class:"text-muted-foreground"},"Actualizado:",-1)),e("span",as,d(f.value.updated_at),1)])]),e("div",ns,[e("button",{onClick:t[8]||(t[8]=r=>p(f.value)),class:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-secondary py-2 text-secondary-foreground transition-colors hover:bg-secondary/90"},[o(s(q),{class:"h-4 w-4"}),t[39]||(t[39]=x(" Ver Historial ",-1))]),o(s(F),{href:`/admin/categories/${f.value.id}/edit`,class:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-primary py-2 text-primary-foreground transition-colors hover:bg-primary/90"},{default:m(()=>[o(s(R),{class:"h-4 w-4"}),t[40]||(t[40]=x(" Editar ",-1))]),_:1},8,["href"])])])])])):w("",!0),E.value&&f.value?(l(),u("div",ds,[e("div",ls,[e("div",is,[e("h3",us," Historial: "+d(f.value.name),1),e("button",{onClick:t[9]||(t[9]=r=>E.value=!1),class:"rounded p-1 transition-colors hover:bg-accent"},[o(s(B),{class:"h-5 w-5"})])]),V.value.length===0?(l(),u("div",cs,[o(s(q),{class:"mx-auto mb-4 h-16 w-16 text-muted-foreground"}),t[41]||(t[41]=e("p",{class:"text-muted-foreground"}," No hay historial disponible ",-1))])):(l(),u("div",ms,[(l(!0),u(L,null,O(V.value,r=>(l(),u("div",{key:r.id,class:"flex items-start gap-3 rounded-lg border border-border p-3"},[t[42]||(t[42]=e("div",{class:"mt-2 h-2 w-2 flex-shrink-0 rounded-full bg-primary"},null,-1)),e("div",fs,[e("p",ps,d(r.description),1),e("p",gs," Por "+d(r.user.name)+" • "+d(r.created_at),1)])]))),128))]))])])):w("",!0)]),_:1})],64))}});export{Gs as default};
