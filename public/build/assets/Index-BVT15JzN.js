import{_ as P}from"./index-Dr7hifzf.js";import{_ as z}from"./index-ByX7PKqW.js";import{c as Z}from"./utils-BtbbqlUx.js";import{d as N,c as n,n as H,u as e,o as a,a as ee,b as w,r as B,e as te,f as $,w as r,g as s,h,i as t,j as u,t as y,k as J,l as I,m as se,p as oe,F as V,q as K,s as Q,v as ae}from"./app-2QXCfeMG.js";import{u as le,C as re,S as ie,X as j,_ as ne}from"./AppLayout.vue_vue_type_script_setup_true_lang-D0s4Pvhb.js";import{B as F,a as M,L as de,_ as ue}from"./_plugin-vue_export-helper-D6Za-jf_.js";import{D as ce}from"./download-B-fWZjdw.js";import{E as me}from"./eye-tKbU2OYl.js";import{U as pe}from"./user-CAt4kc2M.js";import{B as fe,L as be}from"./layers-BQAOxn_H.js";import{C as ve}from"./check-CULVh7_j.js";import{_ as ge}from"./Input.vue_vue_type_script_setup_true_lang-KERfUxKb.js";import{_ as U,a as E,b as R,c as q,d as L}from"./SelectValue.vue_vue_type_script_setup_true_lang-CjGhMhOl.js";import{S as xe}from"./search-DEpn_CFc.js";import{F as he}from"./filter-C3BNhBy1.js";import{S as ye}from"./sparkles-DALk1aOj.js";import{C as W}from"./chevron-left-5OENMh_I.js";import{C as Y}from"./chevron-right-CD5--JLw.js";import"./useForwardExpose-WdC8WNUR.js";import"./VisuallyHidden-BVvg5NBU.js";import"./house-Jt9P1-Sj.js";import"./createLucideIcon-CganvotL.js";import"./Collection-p-5Ft2RQ.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-Bsye0hv5.js";import"./index-Cs2OOWYa.js";import"./log-out-BvlH2FDg.js";import"./AppLogoPng.vue_vue_type_script_setup_true_lang-DV5UP9ty.js";import"./clock-7_ft3SL5.js";import"./users-BtwuLIeb.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DAJcy_Cp.js";import"./chevron-up-CHNXZ96O.js";import"./useFormControl-CavhhMIs.js";const ke=N({__name:"Skeleton",props:{class:{}},setup(l){const x=l;return(i,m)=>(a(),n("div",{"data-slot":"skeleton",class:H(e(Z)("animate-pulse rounded-md bg-primary/10",x.class))},null,2))}}),_e={class:"relative aspect-[2/3] overflow-hidden bg-muted"},$e=["src","alt"],we={class:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"},Ce={class:"absolute right-4 bottom-4 left-4"},Se={class:"flex items-center gap-2 text-sm font-medium text-white"},Le={class:"absolute top-3 left-3 flex flex-col gap-2"},Be={class:"flex flex-1 flex-col space-y-3 p-4"},Te=["title"],Ae={class:"flex items-center gap-1.5 text-sm text-muted-foreground"},De={class:"line-clamp-1"},je={class:"flex items-center gap-3 text-xs text-muted-foreground"},Ie={key:0,class:"flex items-center gap-1"},Ve={class:"line-clamp-1"},Fe={key:1,class:"flex items-center gap-1"},Ne={class:"space-y-2 border-t border-border pt-3"},Pe={key:0,class:"flex items-center gap-2 rounded-lg border border-blue-200 bg-blue-50 px-3 py-2 dark:border-blue-800 dark:bg-blue-900/20"},Me={key:0},Ue={key:1},Ee={key:2},Re=N({__name:"BookCard",props:{book:{},userHasLoaned:{type:Boolean,default:!1}},emits:["loaded"],setup(l,{emit:x}){const i=l,{isInCart:m,addToCart:f}=le(),c=ee(),S=w(()=>!!c.props.auth?.user),b=B(!1),A=B(!1),p=B(!1),d=B(null),v=w(()=>{if(!i.book.contributors||i.book.contributors.length===0)return"Autor desconocido";const C=i.book.contributors.filter(g=>g.contributor_type==="author").map(g=>g.full_name);return C.length>0?C.join(", "):"Autor desconocido"}),T=w(()=>{const C=i.book.book_type==="physical"||i.book.book_type==="both",g=i.book.book_type==="digital"||i.book.book_type==="both",D=i.book.available_copies_count||0;return C&&D>0?{text:`${D} ${D===1?"copia disponible":"copias disponibles"}`,icon:F,variant:"secondary"}:C&&D===0?{text:"Sin copias disponibles",icon:M,variant:"destructive"}:g?{text:"PDF Disponible",icon:ce,variant:"default"}:{text:"No disponible",icon:M,variant:"outline"}}),_=w(()=>i.book.cover_url||"/images/book-placeholder.svg"),o=w(()=>{const C=i.book.book_type==="physical"||i.book.book_type==="both",g=i.book.available_copies_count||0;return C&&g>0&&S.value&&!i.userHasLoaned}),k=async C=>{if(C.preventDefault(),C.stopPropagation(),!o.value||b.value)return;b.value=!0,await f(i.book.id)&&(A.value=!0,setTimeout(()=>{A.value=!1},2e3)),b.value=!1},O=x,X=()=>{p.value=!0,O("loaded")};return te(()=>{d.value?.complete&&X()}),(C,g)=>(a(),$(e(I),{href:`/books/${l.book.id}`,class:"group flex h-full flex-col overflow-hidden rounded-xl border border-border bg-card transition-all duration-300 hover:-translate-y-1 hover:border-primary/50 hover:shadow-lg"},{default:r(()=>[s("div",_e,[p.value?h("",!0):(a(),$(e(ke),{key:0,class:"absolute inset-0 h-full w-full"})),s("img",{ref_key:"imageRef",ref:d,src:_.value,alt:l.book.title,loading:"lazy",decoding:"async",class:H(["h-full w-full object-cover transition-transform duration-500 group-hover:scale-105",{"opacity-0":!p.value,"opacity-100":p.value}]),onLoad:X,onError:g[0]||(g[0]=D=>{const G=D.target;G.src.includes("placeholder")||(G.src="/images/book-placeholder.svg"),p.value=!0,O("loaded")})},null,42,$e),s("div",we,[s("div",Ce,[s("p",Se,[t(e(me),{class:"h-4 w-4"}),u(" "+y(l.book.total_views||0)+" vistas ",1)])])]),s("div",Le,[l.book.featured?(a(),$(e(P),{key:0,variant:"default",class:"bg-yellow-500 text-white hover:bg-yellow-600 border-none shadow-md"},{default:r(()=>[...g[1]||(g[1]=[u(" Destacado ",-1)])]),_:1})):h("",!0),l.book.categories&&l.book.categories.length>0?(a(),$(e(P),{key:1,variant:"outline",class:"bg-background/90 text-foreground backdrop-blur-sm hover:bg-background/100 shadow-sm border-none"},{default:r(()=>[u(y(l.book.categories[0].name),1)]),_:1})):h("",!0)])]),s("div",Be,[s("h3",{class:"line-clamp-2 min-h-[3rem] font-semibold text-foreground transition-colors group-hover:text-primary",title:l.book.title},y(l.book.title),9,Te),s("p",Ae,[t(e(pe),{class:"h-3.5 w-3.5 flex-shrink-0"}),s("span",De,y(v.value),1)]),s("div",je,[l.book.publisher?(a(),n("span",Ie,[t(e(fe),{class:"h-3.5 w-3.5"}),s("span",Ve,y(l.book.publisher.name),1)])):h("",!0),l.book.publication_year?(a(),n("span",Fe,[t(e(re),{class:"h-3.5 w-3.5"}),u(" "+y(l.book.publication_year),1)])):h("",!0)]),g[3]||(g[3]=s("div",{class:"flex-1"},null,-1)),s("div",Ne,[l.userHasLoaned?(a(),n("div",Pe,[t(e(M),{class:"h-4 w-4 flex-shrink-0 text-blue-600 dark:text-blue-400"}),g[2]||(g[2]=s("span",{class:"text-sm font-medium text-blue-600 dark:text-blue-400"}," Préstamo activo ",-1))])):h("",!0),t(e(P),{variant:T.value.variant,class:"flex w-full items-center justify-center gap-2 py-2 text-sm font-medium"},{default:r(()=>[(a(),$(J(T.value.icon),{class:"h-4 w-4 flex-shrink-0"})),u(" "+y(T.value.text),1)]),_:1},8,["variant"]),o.value?(a(),$(e(z),{key:1,onClick:k,disabled:e(m)(l.book.id)||b.value,class:H(["w-full gap-2",{"border-green-500 bg-green-50 text-green-700 hover:bg-green-100 hover:text-green-800 dark:border-green-800 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/40":e(m)(l.book.id)}]),variant:e(m)(l.book.id)?"outline":"default"},{default:r(()=>[(a(),$(J(e(m)(l.book.id)?e(ve):e(ie)),{class:"h-4 w-4"})),e(m)(l.book.id)?(a(),n("span",Me,"En carrito")):b.value?(a(),n("span",Ue,"Agregando...")):(a(),n("span",Ee,"Agregar"))]),_:1},8,["disabled","variant","class"])):h("",!0)])])]),_:1},8,["href"]))}}),qe={class:"space-y-6"},ze={class:"relative max-w-2xl"},He={class:"grid grid-cols-1 gap-4 md:grid-cols-4"},Ke={class:"space-y-2"},Oe={class:"flex items-center gap-2 text-sm font-medium text-foreground"},Xe={class:"flex items-center gap-2"},Ge={key:0,class:"text-xs text-muted-foreground"},Je={class:"space-y-2"},Qe={class:"flex items-center gap-2 text-sm font-medium text-foreground"},We={class:"space-y-2"},Ye={class:"flex items-center gap-2 text-sm font-medium text-foreground"},Ze={class:"flex items-end gap-2"},et={key:0,class:"flex flex-wrap gap-2"},tt={key:0,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-sm text-primary"},st={key:1,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-sm text-primary"},ot={key:2,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-sm text-primary"},at={key:3,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-sm text-primary"},lt=N({__name:"BookFilters",props:{categories:{},filters:{}},setup(l){const x=l,i=B(x.filters.search||""),m=B(x.filters.category||""),f=B(x.filters.type||""),c=B(x.filters.availability||"");se(()=>x.filters,_=>{i.value=_.search||"",m.value=_.category||"",f.value=_.type||"",c.value=_.availability||""},{deep:!0});const S=w(()=>i.value||m.value||f.value||c.value),b=()=>{Q.get("/books",{search:i.value||void 0,category:m.value||void 0,type:f.value||void 0,availability:c.value||void 0},{preserveState:!0,preserveScroll:!0})},A=()=>{i.value="",m.value="",f.value="",c.value="",Q.get("/books",{},{preserveState:!0,preserveScroll:!0})},p=()=>{b()},d=_=>{m.value=_,b()},v=_=>{f.value=_,b()},T=_=>{c.value=_,b()};return(_,o)=>(a(),n("div",qe,[s("div",ze,[t(e(xe),{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(ge),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=k=>i.value=k),type:"text",placeholder:"Buscar por título, autor, ISBN...",class:"h-12 pl-9 pr-12 text-base",onKeyup:oe(p,["enter"])},null,8,["modelValue"]),i.value?(a(),n("button",{key:0,onClick:o[1]||(o[1]=k=>{i.value="",b()}),class:"absolute top-1/2 right-3 -translate-y-1/2 rounded-full p-1 transition-colors hover:bg-muted"},[t(e(j),{class:"h-4 w-4 text-muted-foreground"})])):h("",!0)]),s("div",He,[s("div",Ke,[s("label",Oe,[t(e(be),{class:"h-4 w-4"}),o[6]||(o[6]=u(" Categoría ",-1))]),t(e(U),{"model-value":m.value,"onUpdate:modelValue":d},{default:r(()=>[t(e(E),null,{default:r(()=>[t(e(R),{placeholder:"Todas las categorías"})]),_:1}),t(e(q),null,{default:r(()=>[t(e(L),{value:"all"},{default:r(()=>[...o[7]||(o[7]=[u("Todas las categorías",-1)])]),_:1}),(a(!0),n(V,null,K(l.categories,k=>(a(),$(e(L),{key:k.id,value:k.id.toString()},{default:r(()=>[s("span",Xe,[u(y(k.name)+" ",1),k.books_count?(a(),n("span",Ge," ("+y(k.books_count)+") ",1)):h("",!0)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),s("div",Je,[s("label",Qe,[t(e(F),{class:"h-4 w-4"}),o[8]||(o[8]=u(" Tipo ",-1))]),t(e(U),{"model-value":f.value,"onUpdate:modelValue":v},{default:r(()=>[t(e(E),null,{default:r(()=>[t(e(R),{placeholder:"Todos los tipos"})]),_:1}),t(e(q),null,{default:r(()=>[t(e(L),{value:"all"},{default:r(()=>[...o[9]||(o[9]=[u("Todos los tipos",-1)])]),_:1}),t(e(L),{value:"physical"},{default:r(()=>[...o[10]||(o[10]=[u("Solo físicos",-1)])]),_:1}),t(e(L),{value:"digital"},{default:r(()=>[...o[11]||(o[11]=[u("Solo digitales",-1)])]),_:1}),t(e(L),{value:"both"},{default:r(()=>[...o[12]||(o[12]=[u("Físicos y digitales",-1)])]),_:1})]),_:1})]),_:1},8,["model-value"])]),s("div",We,[s("label",Ye,[t(e(he),{class:"h-4 w-4"}),o[13]||(o[13]=u(" Disponibilidad ",-1))]),t(e(U),{"model-value":c.value,"onUpdate:modelValue":T},{default:r(()=>[t(e(E),null,{default:r(()=>[t(e(R),{placeholder:"Todas"})]),_:1}),t(e(q),null,{default:r(()=>[t(e(L),{value:"all"},{default:r(()=>[...o[14]||(o[14]=[u("Todas",-1)])]),_:1}),t(e(L),{value:"available"},{default:r(()=>[...o[15]||(o[15]=[u("Solo disponibles",-1)])]),_:1}),t(e(L),{value:"downloadable"},{default:r(()=>[...o[16]||(o[16]=[u("Descargables",-1)])]),_:1})]),_:1})]),_:1},8,["model-value"])]),s("div",Ze,[t(e(z),{onClick:p,class:"flex-1"},{default:r(()=>[...o[17]||(o[17]=[u(" Buscar ",-1)])]),_:1}),S.value?(a(),$(e(z),{key:0,onClick:A,variant:"secondary",size:"icon",title:"Limpiar filtros"},{default:r(()=>[t(e(j),{class:"h-4 w-4"})]),_:1})):h("",!0)])]),S.value?(a(),n("div",et,[o[19]||(o[19]=s("span",{class:"text-sm text-muted-foreground self-center"},"Filtros activos:",-1)),i.value?(a(),n("span",tt,[u(' "'+y(i.value)+'" ',1),t(e(j),{class:"h-3 w-3 cursor-pointer hover:text-primary/80",onClick:o[2]||(o[2]=k=>{i.value="",b()})})])):h("",!0),m.value&&m.value!=="all"?(a(),n("span",st,[o[18]||(o[18]=u(" Categoría ",-1)),t(e(j),{class:"h-3 w-3 cursor-pointer hover:text-primary/80",onClick:o[3]||(o[3]=k=>{m.value="",b()})})])):h("",!0),f.value&&f.value!=="all"?(a(),n("span",ot,[u(" Tipo: "+y(f.value==="physical"?"Físico":f.value==="digital"?"Digital":"Ambos")+" ",1),t(e(j),{class:"h-3 w-3 cursor-pointer hover:text-primary/80",onClick:o[4]||(o[4]=k=>{f.value="",b()})})])):h("",!0),c.value&&c.value!=="all"?(a(),n("span",at,[u(y(c.value==="available"?"Disponibles":"Descargables")+" ",1),t(e(j),{class:"h-3 w-3 cursor-pointer hover:text-primary/80",onClick:o[5]||(o[5]=k=>{c.value="",b()})})])):h("",!0)])):h("",!0)]))}}),rt={class:"space-y-8 p-6"},it={class:"flex items-center justify-between"},nt={class:"flex items-center gap-3 text-4xl font-bold text-foreground"},dt={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"},ut={class:"mt-2 flex items-center gap-2 text-muted-foreground"},ct={class:"hidden items-center gap-2 rounded-xl border border-primary/20 bg-primary/10 px-6 py-3 text-primary md:flex"},mt={class:"text-right"},pt={class:"text-2xl font-bold"},ft={class:"flex items-center justify-between"},bt={class:"text-sm text-muted-foreground"},vt={key:0,class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},gt={key:1,class:"flex flex-col items-center justify-center space-y-6 py-20 text-center"},xt={class:"flex h-24 w-24 items-center justify-center rounded-full bg-muted/50 shadow-inner"},ht={key:2,class:"flex items-center justify-center gap-2 pt-8"},yt={key:1,disabled:"",class:"inline-flex cursor-not-allowed items-center gap-2 rounded-lg border border-border bg-background px-4 py-2 opacity-50"},kt={class:"flex items-center gap-1"},_t={key:0,class:"px-4 py-2 text-muted-foreground"},$t={key:2,class:"inline-flex h-10 w-10 items-center justify-center rounded-lg bg-primary font-medium text-primary-foreground"},wt={key:3,disabled:"",class:"inline-flex cursor-not-allowed items-center gap-2 rounded-lg border border-border bg-background px-4 py-2 opacity-50"},Ct=N({__name:"Index",props:{books:{},categories:{},filters:{},userLoanedBookIds:{default:()=>[]}},setup(l){const x=l,i=[{title:"Inicio",href:"/"},{title:"Catálogo de Libros",href:"/books"}],m=w(()=>x.books.data.length>0),f=w(()=>x.books.total),c=w(()=>x.books.current_page),S=w(()=>x.books.last_page),b=w(()=>{const p=[];for(let v=Math.max(2,c.value-2);v<=Math.min(S.value-1,c.value+2);v++)p.push(v);return c.value-2>2&&p.unshift("..."),c.value+2<S.value-1&&p.push("..."),p.unshift(1),S.value>1&&p.push(S.value),p}),A=w(()=>{const p=(c.value-1)*x.books.per_page+1,d=Math.min(c.value*x.books.per_page,f.value);return`Mostrando ${p}-${d} de ${f.value} libros`});return(p,d)=>(a(),n(V,null,[t(e(ae),{title:"Catálogo de Libros"}),t(ne,{breadcrumbs:i},{default:r(()=>[s("div",rt,[s("div",it,[s("div",null,[s("h1",nt,[s("div",dt,[t(e(de),{class:"h-6 w-6 text-primary"})]),d[0]||(d[0]=u(" Catálogo de Libros ",-1))]),s("p",ut,[t(e(F),{class:"h-4 w-4"}),d[1]||(d[1]=u(" Explora nuestra colección de libros físicos y digitales ",-1))])]),s("div",ct,[t(e(ye),{class:"h-5 w-5"}),s("div",mt,[s("p",pt,y(f.value),1),d[2]||(d[2]=s("p",{class:"text-xs text-primary/80"}," Libros disponibles ",-1))])])]),t(lt,{categories:l.categories,filters:l.filters},null,8,["categories","filters"]),s("div",ft,[s("p",bt,y(A.value),1)]),m.value?(a(),n("div",vt,[(a(!0),n(V,null,K(l.books.data,v=>(a(),$(Re,{key:v.id,book:v,"user-has-loaned":l.userLoanedBookIds.includes(v.id)},null,8,["book","user-has-loaned"]))),128))])):(a(),n("div",gt,[s("div",xt,[t(e(F),{class:"h-12 w-12 text-muted-foreground/50"})]),d[4]||(d[4]=s("div",{class:"space-y-2"},[s("h3",{class:"text-2xl font-semibold text-foreground"}," No se encontraron libros "),s("p",{class:"max-w-md text-muted-foreground"}," No hay libros que coincidan con los filtros seleccionados. Intenta ajustar tus criterios de búsqueda o limpiar los filtros. ")],-1)),t(e(I),{href:"/books",class:"inline-flex items-center gap-2 rounded-lg bg-primary px-6 py-3 text-primary-foreground shadow-lg transition-all hover:bg-primary/90 hover:shadow-primary/20"},{default:r(()=>[...d[3]||(d[3]=[u(" Ver todos los libros ",-1)])]),_:1})])),m.value&&S.value>1?(a(),n("div",ht,[l.books.links[0].url?(a(),$(e(I),{key:0,href:l.books.links[0].url,"preserve-scroll":"",class:"inline-flex items-center gap-2 rounded-lg border border-border bg-background px-4 py-2 transition-colors hover:bg-muted"},{default:r(()=>[t(e(W),{class:"h-4 w-4"}),d[5]||(d[5]=s("span",{class:"hidden sm:inline"},"Anterior",-1))]),_:1},8,["href"])):(a(),n("button",yt,[t(e(W),{class:"h-4 w-4"}),d[6]||(d[6]=s("span",{class:"hidden sm:inline"},"Anterior",-1))])),s("div",kt,[(a(!0),n(V,null,K(b.value,(v,T)=>(a(),n(V,{key:T},[v==="..."?(a(),n("span",_t," ... ")):v!==c.value?(a(),$(e(I),{key:1,href:`/books?page=${v}`,"preserve-scroll":"",class:"inline-flex h-10 w-10 items-center justify-center rounded-lg border border-border bg-background transition-colors hover:bg-muted"},{default:r(()=>[u(y(v),1)]),_:2},1032,["href"])):(a(),n("button",$t,y(v),1))],64))),128))]),l.books.links[l.books.links.length-1].url?(a(),$(e(I),{key:2,href:l.books.links[l.books.links.length-1].url,"preserve-scroll":"",class:"inline-flex items-center gap-2 rounded-lg border border-border bg-background px-4 py-2 transition-colors hover:bg-muted"},{default:r(()=>[d[7]||(d[7]=s("span",{class:"hidden sm:inline"},"Siguiente",-1)),t(e(Y),{class:"h-4 w-4"})]),_:1},8,["href"])):(a(),n("button",wt,[d[8]||(d[8]=s("span",{class:"hidden sm:inline"},"Siguiente",-1)),t(e(Y),{class:"h-4 w-4"})]))])):h("",!0)])]),_:1})],64))}}),ls=ue(Ct,[["__scopeId","data-v-6db8617c"]]);export{ls as default};
