import{C as B,_ as z}from"./AppLayout.vue_vue_type_script_setup_true_lang-D0s4Pvhb.js";import{d as F,r as H,b as v,f as w,w as p,i as a,g as e,u as d,v as U,c as n,h as k,o as l,t as o,j as i,F as T,q as L,l as h,n as C,k as M,s as G}from"./app-2QXCfeMG.js";import{a as N}from"./_plugin-vue_export-helper-D6Za-jf_.js";import{P}from"./package-D-VSjK25.js";import{C as R}from"./clock-7_ft3SL5.js";import{E as S}from"./eye-tKbU2OYl.js";import{T as O}from"./trash-2-CPhtcKjV.js";import{A as X}from"./arrow-right-mEjvuGjK.js";import{I as V}from"./info-DNwtXk6a.js";import{B as J}from"./ban-CF6z8a9d.js";import{C as K}from"./circle-x-yQtUAzs4.js";import{C as Q}from"./circle-check-big-DM20BHtd.js";import{C as $}from"./circle-alert-D1PA4zYl.js";import"./utils-BtbbqlUx.js";import"./useForwardExpose-WdC8WNUR.js";import"./VisuallyHidden-BVvg5NBU.js";import"./house-Jt9P1-Sj.js";import"./createLucideIcon-CganvotL.js";import"./Collection-p-5Ft2RQ.js";import"./index-ByX7PKqW.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-Bsye0hv5.js";import"./index-Cs2OOWYa.js";import"./log-out-BvlH2FDg.js";import"./AppLogoPng.vue_vue_type_script_setup_true_lang-DV5UP9ty.js";import"./users-BtwuLIeb.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DAJcy_Cp.js";import"./chevron-right-CD5--JLw.js";const W={class:"container mx-auto max-w-7xl px-4 py-8"},Y={class:"mb-8"},Z={class:"mb-2 flex items-center gap-3"},ee={class:"rounded-xl bg-primary/10 p-3"},te={key:0,class:"mb-6 rounded-lg border border-green-200 bg-green-50 p-4 dark:border-green-800 dark:bg-green-900/20"},re={class:"flex items-start gap-3"},se={class:"mb-8 grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-6"},oe={class:"rounded-xl border border-border bg-card p-4 shadow-sm"},ae={class:"text-2xl font-bold text-foreground"},de={class:"rounded-xl border border-yellow-200 bg-yellow-50 p-4 shadow-sm dark:border-yellow-800 dark:bg-yellow-900/20"},le={class:"text-2xl font-bold text-yellow-900 dark:text-yellow-100"},ne={class:"rounded-xl border border-green-200 bg-green-50 p-4 shadow-sm dark:border-green-800 dark:bg-green-900/20"},ie={class:"text-2xl font-bold text-green-900 dark:text-green-100"},ce={class:"rounded-xl border border-blue-200 bg-blue-50 p-4 shadow-sm dark:border-blue-800 dark:bg-blue-900/20"},ue={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},xe={class:"rounded-xl border border-gray-200 bg-gray-50 p-4 shadow-sm dark:border-gray-800 dark:bg-gray-900/20"},ge={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},me={class:"rounded-xl border border-gray-200 bg-gray-50 p-4 shadow-sm dark:border-gray-800 dark:bg-gray-900/20"},be={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},pe={key:1,class:"mb-8"},fe={class:"mb-4 flex items-center gap-2 text-xl font-bold text-foreground"},ye={class:"text-sm font-normal text-muted-foreground"},ke={class:"grid grid-cols-1 gap-4 lg:grid-cols-2"},he={class:"flex gap-4"},_e={class:"shrink-0"},ve=["src","alt"],we={class:"min-w-0 flex-1"},Ce={class:"mb-2"},Re={class:"text-sm text-muted-foreground"},De={class:"mb-3"},Ee={class:"mb-3 space-y-1 text-sm"},Ae={class:"flex items-center gap-2 text-muted-foreground"},Be={class:"flex items-center gap-2"},Te={key:0},Le={class:"flex gap-2"},Me=["onClick","disabled"],Ne={key:2,class:"mb-8 rounded-xl border border-border bg-card p-12 text-center"},Pe={key:3},Se={class:"mb-4 flex items-center gap-2 text-xl font-bold text-foreground"},Ve={class:"text-sm font-normal text-muted-foreground"},$e={class:"overflow-hidden rounded-xl border border-border bg-card"},qe={class:"overflow-x-auto"},Ie={class:"w-full"},je={class:"divide-y divide-border"},ze={class:"px-4 py-3"},Fe={class:"flex items-center gap-3"},He=["src","alt"],Ue={class:"line-clamp-1 text-sm font-medium text-foreground"},Ge={class:"text-xs text-muted-foreground"},Oe={class:"px-4 py-3 text-sm text-muted-foreground"},Xe={class:"px-4 py-3 text-sm text-muted-foreground"},Je={class:"px-4 py-3"},Ke={class:"px-4 py-3"},Qe={class:"mt-8 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-900/20"},We={class:"flex items-start gap-3"},Dt=F({__name:"Index",props:{reservations:{},stats:{}},setup(c){const D=c,q=[{title:"Inicio",href:"/"},{title:"Mis Reservas",href:"/reservations"}],m=H(null),f=v(()=>D.reservations.data.filter(s=>s.status==="pending"||s.status==="ready")),_=v(()=>D.reservations.data.filter(s=>s.status==="collected"||s.status==="expired"||s.status==="cancelled")),I=v(()=>f.value.some(s=>s.status==="ready")),y=s=>s?new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"N/A",b=s=>{const t=new Date,x=new Date(s).getTime()-t.getTime();return Math.ceil(x/(1e3*60*60*24))},u=s=>{const t=b(s.pickup_deadline);switch(s.status){case"pending":return{text:"Pendiente",icon:R,class:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border border-yellow-300 dark:border-yellow-800"};case"ready":return t<=1?{text:"¡Recoge hoy!",icon:$,class:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 border border-red-300 dark:border-red-800 animate-pulse"}:t<=2?{text:"Listo - Urgente",icon:$,class:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}:{text:"Listo para recoger",icon:P,class:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 border border-green-300 dark:border-green-800"};case"collected":return{text:"Recogido",icon:Q,class:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 border border-blue-300 dark:border-blue-800"};case"expired":return{text:"Expirada",icon:K,class:"bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-400 border border-gray-300 dark:border-gray-800"};case"cancelled":return{text:"Cancelada",icon:J,class:"bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-400 border border-gray-300 dark:border-gray-800"};default:return{text:"Desconocido",icon:V,class:"bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-400 border border-gray-300 dark:border-gray-800"}}},E=s=>{if(!s.contributors||s.contributors.length===0)return"Autor desconocido";const t=s.contributors.filter(r=>r.contributor_type==="author").map(r=>r.full_name);return t.length>0?t.join(", "):"Autor desconocido"},A=s=>s.cover_url||"/images/book-placeholder.svg",j=async s=>{confirm("¿Estás seguro de que deseas cancelar esta reserva?")&&(m.value=s,G.delete(`/reservations/${s}`,{preserveScroll:!0,onSuccess:()=>{m.value=null},onError:t=>{console.error("Error al cancelar reserva:",t),m.value=null,alert("Ocurrió un error al cancelar la reserva. Por favor, intenta de nuevo.")}}))};return(s,t)=>(l(),w(z,{title:"Mis Reservas",breadcrumbs:q},{default:p(()=>[a(d(U),{title:"Mis Reservas"}),e("div",W,[e("div",Y,[e("div",Z,[e("div",ee,[a(d(N),{class:"h-8 w-8 text-primary"})]),t[2]||(t[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-foreground"}," Mis Reservas "),e("p",{class:"text-muted-foreground"}," Gestiona tus reservas de libros ")],-1))])]),I.value?(l(),n("div",te,[e("div",re,[a(d(P),{class:"mt-0.5 h-5 w-5 shrink-0 text-green-600 dark:text-green-400"}),t[3]||(t[3]=e("div",null,[e("h3",{class:"mb-1 font-semibold text-green-900 dark:text-green-100"}," ¡Tienes libros listos para recoger! "),e("p",{class:"text-sm text-green-700 dark:text-green-300"}," Recuerda pasar por la biblioteca antes de la fecha límite para recoger tus libros reservados. ")],-1))])])):k("",!0),e("div",se,[e("div",oe,[t[4]||(t[4]=e("p",{class:"mb-1 text-xs text-muted-foreground"},"Total",-1)),e("p",ae,o(c.stats.total),1)]),e("div",de,[t[5]||(t[5]=e("p",{class:"mb-1 text-xs text-yellow-700 dark:text-yellow-400"}," Pendientes ",-1)),e("p",le,o(c.stats.pending),1)]),e("div",ne,[t[6]||(t[6]=e("p",{class:"mb-1 text-xs text-green-700 dark:text-green-400"}," Listas ",-1)),e("p",ie,o(c.stats.ready),1)]),e("div",ce,[t[7]||(t[7]=e("p",{class:"mb-1 text-xs text-blue-700 dark:text-blue-400"}," Recogidas ",-1)),e("p",ue,o(c.stats.collected),1)]),e("div",xe,[t[8]||(t[8]=e("p",{class:"mb-1 text-xs text-gray-700 dark:text-gray-400"}," Expiradas ",-1)),e("p",ge,o(c.stats.expired),1)]),e("div",me,[t[9]||(t[9]=e("p",{class:"mb-1 text-xs text-gray-700 dark:text-gray-400"}," Canceladas ",-1)),e("p",be,o(c.stats.cancelled),1)])]),f.value.length>0?(l(),n("div",pe,[e("h2",fe,[a(d(R),{class:"h-5 w-5 text-primary"}),t[10]||(t[10]=i(" Reservas Activas ",-1)),e("span",ye,"("+o(f.value.length)+")",1)]),e("div",ke,[(l(!0),n(T,null,L(f.value,r=>(l(),n("div",{key:r.id,class:"rounded-xl border border-border bg-card p-4 transition-shadow hover:shadow-lg"},[e("div",he,[e("div",_e,[e("img",{src:A(r.book),alt:r.book.title,class:"h-28 w-20 rounded-lg object-cover shadow-md",onError:t[0]||(t[0]=x=>{const g=x.target;g.src.includes("placeholder")||(g.src="/images/book-placeholder.svg")})},null,40,ve)]),e("div",we,[e("div",Ce,[a(d(h),{href:`/books/${r.book.id}`,class:"line-clamp-2 font-semibold text-foreground transition-colors hover:text-primary"},{default:p(()=>[i(o(r.book.title),1)]),_:2},1032,["href"]),e("p",Re,o(E(r.book)),1)]),e("div",De,[e("span",{class:C([u(r).class,"inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-medium"])},[(l(),w(M(u(r).icon),{class:"h-3.5 w-3.5"})),i(" "+o(u(r).text),1)],2)]),e("div",Ee,[e("div",Ae,[a(d(B),{class:"h-4 w-4"}),e("span",null,"Reservado: "+o(y(r.reservation_date)),1)]),e("div",Be,[a(d(R),{class:"h-4 w-4"}),e("span",{class:C(b(r.pickup_deadline)<=1?"font-semibold text-red-600 dark:text-red-400":b(r.pickup_deadline)<=2?"font-semibold text-orange-600 dark:text-orange-400":"text-muted-foreground")},[i(" Recoger antes: "+o(y(r.pickup_deadline))+" ",1),r.status==="ready"?(l(),n("span",Te," ("+o(b(r.pickup_deadline))+" días) ",1)):k("",!0)],2)])]),e("div",Le,[a(d(h),{href:`/books/${r.book.id}`,class:"inline-flex items-center gap-1 rounded-lg border border-primary/20 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/5 hover:text-primary/80"},{default:p(()=>[a(d(S),{class:"h-4 w-4"}),t[11]||(t[11]=i(" Ver libro ",-1))]),_:1},8,["href"]),r.status==="pending"||r.status==="ready"&&b(r.pickup_deadline)>0?(l(),n("button",{key:0,onClick:x=>j(r.id),disabled:m.value===r.id,class:"inline-flex items-center gap-1 rounded-lg border border-destructive/20 px-3 py-1.5 text-sm font-medium text-destructive transition-colors hover:bg-destructive/5 hover:text-destructive/80 disabled:cursor-not-allowed disabled:opacity-50"},[a(d(O),{class:"h-4 w-4"}),i(" "+o(m.value===r.id?"Cancelando...":"Cancelar"),1)],8,Me)):k("",!0)])])])]))),128))])])):(l(),n("div",Ne,[a(d(N),{class:"mx-auto mb-4 h-16 w-16 text-muted-foreground opacity-50"}),t[13]||(t[13]=e("h3",{class:"mb-2 text-xl font-semibold text-foreground"}," No tienes reservas activas ",-1)),t[14]||(t[14]=e("p",{class:"mb-6 text-muted-foreground"}," Cuando reserves un libro, aparecerá aquí ",-1)),a(d(h),{href:"/books",class:"inline-flex items-center gap-2 rounded-lg bg-primary px-6 py-3 font-medium text-primary-foreground transition-colors hover:bg-primary/90"},{default:p(()=>[t[12]||(t[12]=i(" Explorar catálogo ",-1)),a(d(X),{class:"h-4 w-4"})]),_:1})])),_.value.length>0?(l(),n("div",Pe,[e("h2",Se,[a(d(B),{class:"h-5 w-5 text-muted-foreground"}),t[15]||(t[15]=i(" Historial de Reservas ",-1)),e("span",Ve,"("+o(_.value.length)+")",1)]),e("div",$e,[e("div",qe,[e("table",Ie,[t[17]||(t[17]=e("thead",{class:"border-b border-border bg-muted/50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium tracking-wider text-muted-foreground uppercase"}," Libro "),e("th",{class:"px-4 py-3 text-left text-xs font-medium tracking-wider text-muted-foreground uppercase"}," Reservado "),e("th",{class:"px-4 py-3 text-left text-xs font-medium tracking-wider text-muted-foreground uppercase"}," Deadline "),e("th",{class:"px-4 py-3 text-left text-xs font-medium tracking-wider text-muted-foreground uppercase"}," Estado "),e("th",{class:"px-4 py-3 text-left text-xs font-medium tracking-wider text-muted-foreground uppercase"}," Acción ")])],-1)),e("tbody",je,[(l(!0),n(T,null,L(_.value,r=>(l(),n("tr",{key:r.id,class:"transition-colors hover:bg-muted/30"},[e("td",ze,[e("div",Fe,[e("img",{src:A(r.book),alt:r.book.title,class:"h-14 w-10 rounded object-cover shadow-sm",onError:t[1]||(t[1]=x=>{const g=x.target;g.src.includes("placeholder")||(g.src="/images/book-placeholder.svg")})},null,40,He),e("div",null,[e("p",Ue,o(r.book.title),1),e("p",Ge,o(E(r.book)),1)])])]),e("td",Oe,o(y(r.reservation_date)),1),e("td",Xe,o(y(r.pickup_deadline)),1),e("td",Je,[e("span",{class:C([u(r).class,"inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium"])},[(l(),w(M(u(r).icon),{class:"h-3 w-3"})),i(" "+o(u(r).text),1)],2)]),e("td",Ke,[a(d(h),{href:`/books/${r.book.id}`,class:"inline-flex items-center gap-1 text-sm font-medium text-primary hover:text-primary/80"},{default:p(()=>[a(d(S),{class:"h-4 w-4"}),t[16]||(t[16]=i(" Ver ",-1))]),_:1},8,["href"])])]))),128))])])])])])):k("",!0),e("div",Qe,[e("div",We,[a(d(V),{class:"mt-0.5 h-5 w-5 shrink-0 text-blue-600 dark:text-blue-400"}),t[18]||(t[18]=e("div",{class:"text-sm text-blue-900 dark:text-blue-100"},[e("p",{class:"mb-2 font-semibold"}," Información sobre reservas: "),e("ul",{class:"list-inside list-disc space-y-1 text-blue-700 dark:text-blue-300"},[e("li",null," Las reservas tienen un plazo de 7 días para recoger el libro "),e("li",null," Si no recoges el libro a tiempo, la reserva expirará automáticamente "),e("li",null," Puedes cancelar una reserva en cualquier momento antes de que expire "),e("li",null," Máximo 5 reservas activas simultáneas por usuario "),e("li",null," Recibirás una notificación cuando tu libro esté listo para recoger ")])],-1))])])])]),_:1}))}});export{Dt as default};
