import{_ as j}from"./index-DdRYoR76.js";import{_ as c}from"./index-BP8NaMnx.js";import{c as x,b,_ as A,a as I}from"./CardTitle.vue_vue_type_script_setup_true_lang-G1xx1pv-.js";import{_ as G}from"./CardDescription.vue_vue_type_script_setup_true_lang-C7_bnbMg.js";import{C as H,_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dg9vcmqC.js";import{d as O,r as P,b as v,c as m,i as r,w as o,g as e,t as l,u as s,v as W,h as y,j as n,l as g,o as u,F as w,q as E,n as L,f as B,k as q}from"./app-LMLfy6T_.js";import{D as h}from"./download-CbaCTKRJ.js";import{A as J}from"./arrow-left-DZ8dX4eD.js";import{B as _}from"./_plugin-vue_export-helper-Cs5A_DpR.js";import{T as K}from"./trending-up-gtAke1Q_.js";import{H as Q}from"./hash-B42vCzQp.js";import{G as U}from"./globe-DDpCIurT.js";import{F as R}from"./file-text-BPA7HujH.js";import{E as X}from"./eye-DS3jVQrj.js";import{a as Y,C as Z}from"./chevron-up-BIDXjghQ.js";import{U as ee}from"./user-ZOL3awYl.js";import"./utils-DXrZ82kT.js";import"./useForwardExpose-BGfwThGJ.js";import"./VisuallyHidden-B-IbK-2_.js";import"./house-JRBk0Cia.js";import"./createLucideIcon-DAteRrvL.js";import"./Collection-CHrqpE2f.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-BtwHaQnx.js";import"./index-Cs2OOWYa.js";import"./log-out-B30-6VwK.js";import"./clock-DEh5UtGW.js";import"./users-DURgrSZU.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-bAsAvttd.js";import"./chevron-right-ti3lw4Bb.js";const te={class:"space-y-6 p-6"},se={class:"flex items-center justify-between"},re={class:"mt-2 flex items-center gap-2 text-muted-foreground"},oe={class:"flex items-center gap-3"},ae={class:"grid grid-cols-1 gap-6 md:grid-cols-3"},le={class:"flex items-center justify-between"},ne={class:"text-3xl font-bold text-foreground"},ie={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-500/20"},de={class:"flex items-center justify-between"},ue={class:"text-3xl font-bold text-foreground"},me={class:"mt-1 text-xs text-muted-foreground"},fe={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-green-500/20"},ce={class:"flex items-center justify-between"},ge={class:"text-3xl font-bold text-foreground"},pe={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-purple-500/20"},xe={key:0,class:"divide-y divide-border"},be={class:"flex items-start justify-between"},he={class:"min-w-0 flex-1"},_e={class:"flex items-start gap-4"},ve={class:"mt-1 flex h-16 w-12 flex-shrink-0 items-center justify-center rounded-lg bg-primary/10"},ye={class:"min-w-0 flex-1"},we={class:"mb-2 text-lg font-semibold text-foreground transition-colors group-hover:text-primary"},ke={class:"mb-3 flex flex-wrap items-center gap-4 text-sm text-muted-foreground"},De={class:"flex items-center gap-1"},$e={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Se={class:"flex flex-wrap gap-2"},Te={key:0,class:"mt-4 border-t border-border pt-4 pl-16"},je={class:"grid grid-cols-1 gap-4 text-sm md:grid-cols-2"},He={class:"mb-2 flex items-center gap-2 font-medium text-foreground"},Ee={class:"space-y-1 text-muted-foreground"},Le={key:0,class:"break-all"},Be={class:"mb-2 flex items-center gap-2 font-medium text-foreground"},Ue={class:"space-y-1 text-muted-foreground"},Ve={class:"ml-4 flex flex-shrink-0 items-center gap-2"},Ne={key:1,class:"m-6 rounded-xl border-2 border-dashed border-border py-16 text-center"},Fe={class:"mx-auto max-w-md"},ze={class:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10 p-4"},Ae={class:"mb-6 text-lg text-muted-foreground"},Ie={class:"flex justify-center gap-3"},Ge={key:0,class:"flex justify-center"},Me={class:"flex gap-2"},Oe={class:"grid grid-cols-1 gap-6 text-center md:grid-cols-4"},Pe={class:"text-2xl font-bold text-foreground"},We={class:"text-2xl font-bold text-foreground"},qe={class:"text-2xl font-bold text-foreground"},Je={class:"text-2xl font-bold text-foreground"},Dt=O({__name:"DownloadHistory",props:{user:{},downloads:{}},setup(i){const f=i,V=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:`${f.user.name} ${f.user.last_name}`,href:`/admin/users/${f.user.id}`},{title:"Historial de Descargas",href:"#"}],p=P(new Set);function k(d){return new Date(d).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function N(d){return new Date(d).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}function F(d){p.value.has(d)?p.value.delete(d):p.value.add(d)}const z={digital:"bg-blue-500/10 text-blue-600 border-blue-200 dark:bg-blue-500/20 dark:text-blue-400 dark:border-blue-800",physical:"bg-green-500/10 text-green-600 border-green-200 dark:bg-green-500/20 dark:text-green-400 dark:border-green-800",both:"bg-purple-500/10 text-purple-600 border-purple-200 dark:bg-purple-500/20 dark:text-purple-400 dark:border-purple-800"},D={digital:"Digital",physical:"Físico",both:"Ambos"},$=v(()=>f.downloads.total),C=v(()=>{const d=new Date().toDateString();return f.downloads.data.filter(t=>new Date(t.downloaded_at).toDateString()===d).length}),S=v(()=>{const d=new Date;return d.setDate(d.getDate()-7),f.downloads.data.filter(t=>new Date(t.downloaded_at)>=d).length});return(d,t)=>(u(),m(w,null,[r(s(W),null,{default:o(()=>[e("title",null,"Historial de Descargas - "+l(i.user.name),1)]),_:1}),r(M,{breadcrumbs:V},{default:o(()=>[e("div",te,[e("div",se,[e("div",null,[t[0]||(t[0]=e("h1",{class:"text-3xl font-bold text-foreground"}," Historial de Descargas ",-1)),e("p",re,[r(s(h),{class:"h-4 w-4 text-primary"}),n(" Todas las descargas realizadas por "+l(i.user.name)+" "+l(i.user.last_name),1)])]),e("div",oe,[r(s(c),{variant:"outline","as-child":""},{default:o(()=>[r(s(g),{href:`/admin/users/${i.user.id}`},{default:o(()=>[r(s(J),{class:"mr-2 h-4 w-4"}),t[1]||(t[1]=n(" Volver al Usuario ",-1))]),_:1},8,["href"])]),_:1}),r(s(c),{variant:"outline","as-child":""},{default:o(()=>[r(s(g),{href:`/admin/users/${i.user.id}/loan-history`},{default:o(()=>[r(s(_),{class:"mr-2 h-4 w-4"}),t[2]||(t[2]=n(" Ver Préstamos ",-1))]),_:1},8,["href"])]),_:1})])]),e("div",ae,[r(s(x),{class:"border-blue-200 bg-gradient-to-br from-blue-500/10 to-blue-600/5"},{default:o(()=>[r(s(b),{class:"p-6"},{default:o(()=>[e("div",le,[e("div",null,[t[3]||(t[3]=e("p",{class:"mb-1 text-sm font-medium text-blue-600"}," Total Descargas ",-1)),e("p",ne,l($.value),1),t[4]||(t[4]=e("p",{class:"mt-1 text-xs text-muted-foreground"}," Historial completo ",-1))]),e("div",ie,[r(s(h),{class:"h-6 w-6 text-blue-500"})])])]),_:1})]),_:1}),r(s(x),{class:"border-green-200 bg-gradient-to-br from-green-500/10 to-green-600/5"},{default:o(()=>[r(s(b),{class:"p-6"},{default:o(()=>[e("div",de,[e("div",null,[t[5]||(t[5]=e("p",{class:"mb-1 text-sm font-medium text-green-600"}," Descargas Hoy ",-1)),e("p",ue,l(C.value),1),e("p",me,l(N(new Date().toISOString())),1)]),e("div",fe,[r(s(H),{class:"h-6 w-6 text-green-500"})])])]),_:1})]),_:1}),r(s(x),{class:"border-purple-200 bg-gradient-to-br from-purple-500/10 to-purple-600/5"},{default:o(()=>[r(s(b),{class:"p-6"},{default:o(()=>[e("div",ce,[e("div",null,[t[6]||(t[6]=e("p",{class:"mb-1 text-sm font-medium text-purple-600"}," Esta Semana ",-1)),e("p",ge,l(S.value),1),t[7]||(t[7]=e("p",{class:"mt-1 text-xs text-muted-foreground"}," Últimos 7 días ",-1))]),e("div",pe,[r(s(K),{class:"h-6 w-6 text-purple-500"})])])]),_:1})]),_:1})]),r(s(x),{class:"border-border bg-card shadow-lg"},{default:o(()=>[r(s(A),{class:"border-b border-border bg-muted/50"},{default:o(()=>[r(s(I),{class:"flex items-center gap-2 text-foreground"},{default:o(()=>[r(s(h),{class:"h-5 w-5 text-primary"}),t[8]||(t[8]=n(" Lista de Descargas ",-1))]),_:1}),r(s(G),{class:"text-muted-foreground"},{default:o(()=>[n(l(i.downloads.total)+" descargas encontradas en el historial ",1)]),_:1})]),_:1}),r(s(b),{class:"p-0"},{default:o(()=>[i.downloads.data.length>0?(u(),m("div",xe,[(u(!0),m(w,null,E(i.downloads.data,a=>(u(),m("div",{key:a.id,class:"group p-6 transition-colors hover:bg-accent/50"},[e("div",be,[e("div",he,[e("div",_e,[e("div",ve,[r(s(_),{class:"h-6 w-6 text-primary"})]),e("div",ye,[e("h3",we,l(a.book.title),1),e("div",ke,[e("div",De,[r(s(Q),{class:"h-3 w-3"}),e("span",null,"ISBN: "+l(a.book.isbn),1)]),e("div",$e,[r(s(H),{class:"h-3 w-3"}),e("span",null,l(k(a.downloaded_at)),1)]),e("div",Ce,[r(s(U),{class:"h-3 w-3"}),e("span",null,l(a.ip_address),1)])]),e("div",Se,[r(s(j),{class:L([z[a.book.book_type],"border font-medium"])},{default:o(()=>[n(l(D[a.book.book_type]),1)]),_:2},1032,["class"]),r(s(j),{variant:"outline",class:"border-gray-200 bg-gray-500/10 text-gray-600"},{default:o(()=>[r(s(R),{class:"mr-1 h-3 w-3"}),n(" Descarga #"+l(a.id),1)]),_:2},1024)])])]),p.value.has(a.id)?(u(),m("div",Te,[e("div",je,[e("div",null,[e("h4",He,[r(s(U),{class:"h-4 w-4 text-blue-500"}),t[9]||(t[9]=n(" Información de Conexión ",-1))]),e("div",Ee,[e("p",null,[t[10]||(t[10]=e("strong",null,"IP:",-1)),n(" "+l(a.ip_address),1)]),e("p",null,[t[11]||(t[11]=e("strong",null,"Fecha y Hora:",-1)),n(" "+l(k(a.downloaded_at)),1)]),a.user_agent?(u(),m("p",Le,[t[12]||(t[12]=e("strong",null,"User Agent:",-1)),n(" "+l(a.user_agent),1)])):y("",!0)])]),e("div",null,[e("h4",Be,[r(s(_),{class:"h-4 w-4 text-green-500"}),t[13]||(t[13]=n(" Información del Libro ",-1))]),e("div",Ue,[e("p",null,[t[14]||(t[14]=e("strong",null,"Título:",-1)),n(" "+l(a.book.title),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"ISBN:",-1)),n(" "+l(a.book.isbn),1)]),e("p",null,[t[16]||(t[16]=e("strong",null,"Tipo:",-1)),n(" "+l(D[a.book.book_type]),1)]),r(s(c),{variant:"outline",size:"sm","as-child":"",class:"mt-2"},{default:o(()=>[r(s(g),{href:`/admin/books/${a.book.id}`},{default:o(()=>[r(s(X),{class:"mr-1 h-3 w-3"}),t[17]||(t[17]=n(" Ver libro ",-1))]),_:1},8,["href"])]),_:2},1024)])])])])):y("",!0)]),e("div",Ve,[r(s(c),{variant:"ghost",size:"sm",onClick:T=>F(a.id),class:"h-8 w-8 p-0 opacity-50 transition-opacity group-hover:opacity-100"},{default:o(()=>[(u(),B(q(p.value.has(a.id)?s(Y):s(Z)),{class:"h-4 w-4"}))]),_:2},1032,["onClick"])])])]))),128))])):(u(),m("div",Ne,[e("div",Fe,[e("div",ze,[r(s(h),{class:"h-10 w-10 text-primary"})]),t[20]||(t[20]=e("h3",{class:"mb-3 text-2xl font-bold text-foreground"}," No se encontraron descargas ",-1)),e("p",Ae,l(i.user.name)+" no ha realizado ninguna descarga aún ",1),e("div",Ie,[r(s(c),{variant:"outline","as-child":"",class:"border-primary/20 text-primary hover:bg-primary hover:text-primary-foreground"},{default:o(()=>[r(s(g),{href:`/admin/users/${i.user.id}`},{default:o(()=>[r(s(ee),{class:"mr-2 h-4 w-4"}),t[18]||(t[18]=n(" Volver al Usuario ",-1))]),_:1},8,["href"])]),_:1}),r(s(c),{"as-child":"",class:"bg-primary text-primary-foreground hover:bg-primary/90"},{default:o(()=>[r(s(g),{href:"/admin/books"},{default:o(()=>[r(s(_),{class:"mr-2 h-4 w-4"}),t[19]||(t[19]=n(" Explorar Libros ",-1))]),_:1})]),_:1})])])]))]),_:1})]),_:1}),i.downloads.data.length>0?(u(),m("div",Ge,[e("div",Me,[(u(!0),m(w,null,E(i.downloads.links,(a,T)=>(u(),B(s(g),{key:T,href:a.url??"",disabled:!a.url,class:L(["rounded-lg px-3 py-1.5 text-sm font-medium transition-colors",a.active?"bg-primary text-primary-foreground hover:bg-primary/90":"border border-input bg-background hover:bg-accent hover:text-accent-foreground",a.url?"cursor-pointer":"cursor-not-allowed opacity-50"]),innerHTML:a.label,"preserve-scroll":""},null,8,["href","disabled","class","innerHTML"]))),128))])])):y("",!0),r(s(x),{class:"border-border bg-muted/50"},{default:o(()=>[r(s(b),{class:"p-6"},{default:o(()=>[e("div",Oe,[e("div",null,[e("p",Pe,l($.value),1),t[21]||(t[21]=e("p",{class:"text-sm text-muted-foreground"}," Total Descargas ",-1))]),e("div",null,[e("p",We,l(C.value),1),t[22]||(t[22]=e("p",{class:"text-sm text-muted-foreground"},"Hoy",-1))]),e("div",null,[e("p",qe,l(S.value),1),t[23]||(t[23]=e("p",{class:"text-sm text-muted-foreground"}," Esta Semana ",-1))]),e("div",null,[e("p",Je,l(i.downloads.data.length),1),t[24]||(t[24]=e("p",{class:"text-sm text-muted-foreground"}," En esta página ",-1))])])]),_:1})]),_:1})])]),_:1})],64))}});export{Dt as default};
