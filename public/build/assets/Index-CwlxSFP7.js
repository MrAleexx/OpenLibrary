import{u as A,S as w,C,_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dg9vcmqC.js";import{d as G,r as b,e as O,m as z,b as L,c as d,i as a,u as s,v as H,w as J,g as e,h as m,o,t as i,j as D,F as h,q as P,f as K,s as Q}from"./app-LMLfy6T_.js";import{C as j}from"./circle-check-big-BdqqoiHI.js";import{C as S}from"./circle-alert-CYnwW9m4.js";import{B as v}from"./_plugin-vue_export-helper-Cs5A_DpR.js";import{P as U}from"./package-CXZzcXz_.js";import{T as W}from"./trash-2-foNQ03DZ.js";import"./utils-DXrZ82kT.js";import"./useForwardExpose-BGfwThGJ.js";import"./VisuallyHidden-B-IbK-2_.js";import"./house-JRBk0Cia.js";import"./createLucideIcon-DAteRrvL.js";import"./Collection-CHrqpE2f.js";import"./index-BP8NaMnx.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-BtwHaQnx.js";import"./index-Cs2OOWYa.js";import"./log-out-B30-6VwK.js";import"./clock-DEh5UtGW.js";import"./users-DURgrSZU.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-bAsAvttd.js";import"./chevron-right-ti3lw4Bb.js";const X={class:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8"},Y={class:"mb-8"},Z={class:"mb-2 flex items-center gap-3"},ee={class:"rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 p-2"},te={key:0,class:"mb-6 rounded-lg border border-green-200 bg-green-50 p-4 dark:border-green-800 dark:bg-green-900/20"},se={class:"flex items-center gap-3"},re={class:"text-sm font-medium text-green-800 dark:text-green-300"},ae={key:1,class:"mb-6 rounded-lg border border-red-200 bg-red-50 p-4 dark:border-red-800 dark:bg-red-900/20"},oe={class:"flex items-center gap-3"},de={class:"text-sm font-medium text-red-800 dark:text-red-300"},ie={class:"mb-8 grid grid-cols-1 gap-4 md:grid-cols-3"},ne={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800"},le={class:"flex items-center justify-between"},ce={class:"mt-1 text-2xl font-bold text-gray-900 dark:text-white"},ge={class:"rounded-lg bg-blue-100 p-3 dark:bg-blue-900/30"},me={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800"},ue={class:"flex items-center justify-between"},xe={class:"mt-1 text-2xl font-bold text-gray-900 dark:text-white"},be={class:"rounded-lg bg-purple-100 p-3 dark:bg-purple-900/30"},pe={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800"},ye={class:"flex items-center justify-between"},he={class:"mt-1 text-sm font-semibold text-gray-900 dark:text-white"},ve={class:"rounded-lg bg-green-100 p-3 dark:bg-green-900/30"},ke={class:"grid grid-cols-1 gap-8 lg:grid-cols-3"},fe={class:"space-y-4 lg:col-span-2"},_e={class:"mb-4 flex items-center justify-between"},we={key:0,class:"rounded-xl border border-gray-200 bg-white p-12 text-center dark:border-gray-700 dark:bg-gray-800"},Ce={href:"/books",class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 font-medium text-white transition-colors hover:bg-blue-700"},Le={key:1,class:"space-y-4"},De={key:2,class:"space-y-4"},Pe={class:"flex gap-4"},je={class:"flex-shrink-0"},Se=["src","alt"],Ee={class:"min-w-0 flex-1"},Be={class:"mb-1 truncate text-lg font-semibold text-gray-900 dark:text-white"},Te={class:"mb-2 text-sm text-gray-600 dark:text-gray-400"},Fe={class:"mb-3 flex items-center gap-4 text-xs text-gray-600 dark:text-gray-400"},Ne={class:"flex items-center gap-1"},Ve={class:"flex-shrink-0"},$e=["onClick","disabled"],qe={class:"lg:col-span-1"},Me={class:"sticky top-4 rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800"},Re={class:"mb-6 space-y-4"},Ae={class:"flex justify-between text-sm"},Ie={class:"font-medium text-gray-900 dark:text-white"},Ge={class:"flex justify-between text-sm"},Oe={class:"font-medium text-gray-900 dark:text-white"},ze={class:"flex justify-between text-sm"},He={class:"font-medium text-gray-900 dark:text-white"},Je={class:"space-y-3 border-t border-gray-200 pt-6 dark:border-gray-700"},Ke=["disabled"],Qe={key:1},Ue={key:2},We={href:"/books",class:"flex w-full items-center justify-center gap-2 rounded-lg bg-gray-100 px-6 py-3 font-medium text-gray-900 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600"},Xe={key:0,class:"mt-4 rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-900/20"},Ye={class:"flex items-start gap-2"},Ze={class:"text-xs text-amber-800 dark:text-amber-300"},wt=G({__name:"Index",props:{remainingLoans:{},maxLoans:{},activeLoansCount:{}},setup(c){const{count:l,isEmpty:p,isLoading:u,error:k,getCartItems:E,removeFromCart:B,checkout:T,clearCart:F}=A(),x=b([]),f=b(!1),_=b(""),g=b(!1);O(async()=>{await y()}),z(l,async()=>{await y()});const y=async()=>{x.value=await E()},N=L(()=>{const r=new Date;return r.setDate(r.getDate()+14),r.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}),V=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"});L(()=>14);const $=async r=>{await B(r)&&await y()},q=async()=>{if(g.value||!confirm(`¬øConfirmas que deseas hacer el pr√©stamo de ${l.value} libro(s)?`))return;g.value=!0;const r=await T();r.success&&(f.value=!0,_.value=r.message||"Pr√©stamos creados exitosamente",x.value=[],setTimeout(()=>{Q.visit("/dashboard")},2e3)),g.value=!1},M=async()=>{confirm("¬øEst√°s seguro de que deseas vaciar el carrito?")&&(await F(),x.value=[])},R=r=>!r.contributors||r.contributors.length===0?"Autor desconocido":r.contributors.length===1?r.contributors[0].name:`${r.contributors[0].name} y ${r.contributors.length-1} m√°s`;return(r,t)=>(o(),d(h,null,[a(s(H),{title:"Mi Carrito de Pr√©stamos"}),a(I,null,{default:J(()=>[e("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[a(s(w),{class:"h-6 w-6 text-white"})]),t[0]||(t[0]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Mi Carrito de Pr√©stamos "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Gestiona los libros que deseas pedir prestados ")],-1))])]),f.value?(o(),d("div",te,[e("div",se,[a(s(j),{class:"h-5 w-5 text-green-600 dark:text-green-400"}),e("div",null,[e("p",re,i(_.value),1),t[1]||(t[1]=e("p",{class:"mt-1 text-xs text-green-700 dark:text-green-400"}," Ser√°s redirigido al dashboard... ",-1))])])])):m("",!0),s(k)?(o(),d("div",ae,[e("div",oe,[a(s(S),{class:"h-5 w-5 text-red-600 dark:text-red-400"}),e("p",de,i(s(k)),1)])])):m("",!0),e("div",ie,[e("div",ne,[e("div",le,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Libros en carrito ",-1)),e("p",ce,i(s(l)),1)]),e("div",ge,[a(s(w),{class:"h-6 w-6 text-blue-600 dark:text-blue-400"})])])]),e("div",me,[e("div",ue,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Pr√©stamos activos ",-1)),e("p",xe,i(c.activeLoansCount)+" / "+i(c.maxLoans),1)]),e("div",be,[a(s(v),{class:"h-6 w-6 text-purple-600 dark:text-purple-400"})])])]),e("div",pe,[e("div",ye,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Fecha de devoluci√≥n ",-1)),e("p",he,i(N.value),1)]),e("div",ve,[a(s(C),{class:"h-6 w-6 text-green-600 dark:text-green-400"})])])])]),e("div",ke,[e("div",fe,[e("div",_e,[t[5]||(t[5]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Libros seleccionados ",-1)),s(p)?m("",!0):(o(),d("button",{key:0,onClick:M,class:"text-sm font-medium text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300"}," Vaciar carrito "))]),s(p)&&!s(u)?(o(),d("div",we,[a(s(U),{class:"mx-auto mb-4 h-16 w-16 text-gray-400 dark:text-gray-600"}),t[7]||(t[7]=e("h3",{class:"mb-2 text-lg font-semibold text-gray-900 dark:text-white"}," Tu carrito est√° vac√≠o ",-1)),t[8]||(t[8]=e("p",{class:"mb-6 text-sm text-gray-600 dark:text-gray-400"}," Explora nuestro cat√°logo y agrega libros para pedir prestados ",-1)),e("a",Ce,[a(s(v),{class:"h-4 w-4"}),t[6]||(t[6]=D(" Explorar Cat√°logo ",-1))])])):m("",!0),s(u)?(o(),d("div",Le,[(o(),d(h,null,P(3,n=>e("div",{key:n,class:"animate-pulse rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800"},[...t[9]||(t[9]=[e("div",{class:"flex gap-4"},[e("div",{class:"h-28 w-20 rounded-lg bg-gray-200 dark:bg-gray-700"}),e("div",{class:"flex-1 space-y-3"},[e("div",{class:"h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-700"}),e("div",{class:"h-3 w-1/2 rounded bg-gray-200 dark:bg-gray-700"}),e("div",{class:"h-3 w-2/3 rounded bg-gray-200 dark:bg-gray-700"})])],-1)])])),64))])):(o(),d("div",De,[(o(!0),d(h,null,P(x.value,n=>(o(),d("div",{key:n.id,class:"rounded-xl border border-gray-200 bg-white p-6 transition-colors hover:border-blue-300 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-blue-700"},[e("div",Pe,[e("div",je,[e("img",{src:n.cover_image||"/images/default-book-cover.png",alt:n.title,class:"h-28 w-20 rounded-lg object-cover shadow-md"},null,8,Se)]),e("div",Ee,[e("h3",Be,i(n.title),1),e("p",Te,i(R(n)),1),e("div",Fe,[e("div",Ne,[a(s(C),{class:"h-3 w-3"}),e("span",null,"Devolver: "+i(V(n.dueDate)),1)])]),t[10]||(t[10]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800 dark:bg-green-900/30 dark:text-green-300"}," 14 d√≠as de pr√©stamo ")],-1))]),e("div",Ve,[e("button",{onClick:et=>$(n.id),disabled:s(u),class:"rounded-lg p-2 text-red-600 transition-colors hover:bg-red-50 disabled:opacity-50 dark:text-red-400 dark:hover:bg-red-900/20",title:"Remover del carrito"},[a(s(W),{class:"h-5 w-5"})],8,$e)])])]))),128))]))]),e("div",qe,[e("div",Me,[t[16]||(t[16]=e("h3",{class:"mb-6 text-lg font-semibold text-gray-900 dark:text-white"}," Resumen del Pr√©stamo ",-1)),e("div",Re,[e("div",Ae,[t[11]||(t[11]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Total de libros",-1)),e("span",Ie,i(s(l)),1)]),e("div",Ge,[t[12]||(t[12]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Pr√©stamos disponibles",-1)),e("span",Oe,i(c.remainingLoans),1)]),t[14]||(t[14]=e("div",{class:"flex justify-between text-sm"},[e("span",{class:"text-gray-600 dark:text-gray-400"},"Periodo de pr√©stamo"),e("span",{class:"font-medium text-gray-900 dark:text-white"},"14 d√≠as")],-1)),e("div",ze,[t[13]||(t[13]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Fecha de devoluci√≥n",-1)),e("span",He,i(new Date(Date.now()+336*60*60*1e3).toLocaleDateString("es-ES",{day:"numeric",month:"short"})),1)])]),e("div",Je,[e("button",{onClick:q,disabled:s(p)||g.value||s(u)||c.remainingLoans<s(l),class:"flex w-full items-center justify-center gap-2 rounded-lg bg-blue-600 px-6 py-3 font-medium text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-gray-300 dark:disabled:bg-gray-700"},[g.value?m("",!0):(o(),K(s(j),{key:0,class:"h-5 w-5"})),g.value?(o(),d("span",Qe,"Procesando...")):(o(),d("span",Ue,"Confirmar Pr√©stamo"))],8,Ke),e("a",We,[a(s(v),{class:"h-5 w-5"}),t[15]||(t[15]=D(" Seguir Explorando ",-1))])]),s(l)>c.remainingLoans?(o(),d("div",Xe,[e("div",Ye,[a(s(S),{class:"mt-0.5 h-4 w-4 flex-shrink-0 text-amber-600 dark:text-amber-400"}),e("p",Ze," Excedes el l√≠mite de pr√©stamos. Remueve "+i(s(l)-c.remainingLoans)+" libro(s). ",1)])])):m("",!0),t[17]||(t[17]=e("div",{class:"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-900/20"},[e("p",{class:"text-xs text-blue-800 dark:text-blue-300"}," üí° Los libros deber√°n ser devueltos en 14 d√≠as. Puedes renovar el pr√©stamo si es necesario. ")],-1))])])])])]),_:1})],64))}});export{wt as default};
