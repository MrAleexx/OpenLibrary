import{_ as E,a as T}from"./index-DiYL93hV.js";import{_ as G}from"./index-Dr7hifzf.js";import{_ as m}from"./index-ByX7PKqW.js";import{c as _,_ as y,a as h,b as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-RZ9trK3M.js";import{_ as F}from"./CardDescription.vue_vue_type_script_setup_true_lang-CV9uiqH5.js";import{_ as K}from"./Label.vue_vue_type_script_setup_true_lang-CqE0TfK9.js";import{X,_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-D0s4Pvhb.js";import{d as Q,r as S,a as W,b as k,c,i as r,w as o,g as e,u as t,v as ee,h as p,j as a,l as B,o as i,f as x,t as n,n as $,F as z,q as se,s as U}from"./app-2QXCfeMG.js";import{U as j}from"./users-BtwuLIeb.js";import{Z as te}from"./zap-BdSypASH.js";import{A as re}from"./arrow-left-CWKWrJMG.js";import{C as M}from"./circle-check-big-DM20BHtd.js";import{C as D}from"./circle-alert-D1PA4zYl.js";import{U as V}from"./upload-6FIPfNhl.js";import{F as oe}from"./file-text-DUxpBa_C.js";import{L as ae}from"./loader-circle-Dy1UQBRG.js";import{c as le}from"./createLucideIcon-CganvotL.js";import{F as ie}from"./file-down-BTgF-Dk5.js";import{D as ne}from"./download-B-fWZjdw.js";import{T as de}from"./trending-up-DABNfu_E.js";import{C as ue}from"./clock-7_ft3SL5.js";import{U as me}from"./user-plus-C1G_NWdg.js";import"./utils-BtbbqlUx.js";import"./useForwardExpose-WdC8WNUR.js";import"./VisuallyHidden-BVvg5NBU.js";import"./house-Jt9P1-Sj.js";import"./Collection-p-5Ft2RQ.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-Bsye0hv5.js";import"./index-Cs2OOWYa.js";import"./log-out-BvlH2FDg.js";import"./AppLogoPng.vue_vue_type_script_setup_true_lang-DV5UP9ty.js";import"./_plugin-vue_export-helper-D6Za-jf_.js";import"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DAJcy_Cp.js";import"./chevron-right-CD5--JLw.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=le("FileSearchIcon",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]),pe={class:"space-y-8 p-6"},fe={class:"flex items-center justify-between"},ge={class:"mt-2 flex items-center gap-2 text-muted-foreground"},xe={class:"flex items-center gap-3"},be={class:"flex items-center gap-2 rounded-lg border border-primary/20 bg-primary/10 px-4 py-2 text-primary"},ve={key:0,class:"space-y-4"},_e={class:"grid grid-cols-1 gap-8 lg:grid-cols-3"},ye={class:"space-y-3"},he={class:"mx-auto max-w-md"},we={key:0,class:"rounded-lg border border-border bg-muted/30 p-4"},ke={class:"flex items-center gap-4"},Ce={class:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10"},Ie={class:"min-w-0 flex-1"},Fe={class:"truncate font-medium text-foreground"},Se={class:"mt-1 flex items-center gap-4 text-sm text-muted-foreground"},Be={class:"flex items-center gap-2"},Ue={key:1,class:"space-y-4"},Me={class:"mb-3 flex items-center gap-3"},De={class:"grid grid-cols-2 gap-4 text-sm"},Ve={class:"ml-2"},Ee={class:"ml-2 font-semibold text-green-600"},Te={class:"ml-2 font-semibold text-amber-600"},$e={key:0,class:"mt-4"},ze={class:"mb-2 flex items-center justify-between"},je={class:"max-h-40 space-y-2 overflow-y-auto"},Le={class:"font-medium"},Ae={class:"text-amber-700"},Ne={class:"text-gray-500"},Pe={key:0,class:"py-2 text-center text-xs text-amber-700"},Re={class:"flex justify-end"},qe={class:"space-y-6"},He={class:"text-center"},Ye={class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-xl bg-primary/10"},Oe={class:"space-y-4"},Ze={class:"mb-3 flex items-center gap-2 text-sm font-medium text-foreground"},Ge={class:"border-t border-border pt-4"},Ke={class:"mb-3 flex items-center gap-2 text-sm font-medium text-foreground"},Xe={class:"py-12 text-center"},Je={class:"mx-auto max-w-md"},Qe={class:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10 p-4"},We={class:"flex justify-center gap-3"},zs=Q({__name:"Import",setup(es){const L=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:"Importar Usuarios",href:"#"}],u=S(null),f=S(!1);S(null);const b=W(),C=k(()=>b.props.flash?.success),I=k(()=>b.props.flash?.error),d=k(()=>b.props.flash?.import_results);k(()=>b.props.flash?.import_errors);function A(){const l=document.getElementById("import_file");l&&l.click()}function N(l){const s=l.target;s.files&&s.files[0]&&(u.value=s.files[0])}function P(){u.value=null;const l=document.getElementById("import_file");l&&(l.value="")}function R(){if(!u.value){alert("Por favor selecciona un archivo para importar");return}f.value=!0;const l=new FormData;l.append("import_file",u.value),U.post("/admin/users/import",l,{preserveScroll:!0,onSuccess:()=>{f.value=!1,u.value=null;const s=document.getElementById("import_file");s&&(s.value="")},onError:()=>{f.value=!1}})}function q(){globalThis.location.href="/admin/users/import/template"}function H(){d.value?.has_errors&&(globalThis.location.href="/admin/users/import/report")}function Y(){U.delete("/admin/users/import/session",{preserveScroll:!0,onSuccess:()=>{U.reload({only:[]})}})}function O(l){if(l===0)return"0 Bytes";const s=1024,g=["Bytes","KB","MB","GB"],v=Math.floor(Math.log(l)/Math.log(s));return parseFloat((l/Math.pow(s,v)).toFixed(2))+" "+g[v]}function Z(l){return l-1}return(l,s)=>(i(),c(z,null,[r(t(ee),null,{default:o(()=>[...s[0]||(s[0]=[e("title",null,"Importar Usuarios",-1)])]),_:1}),r(J,{breadcrumbs:L},{default:o(()=>[e("div",pe,[e("div",fe,[e("div",null,[s[2]||(s[2]=e("h1",{class:"text-3xl font-bold text-foreground"}," Importar Usuarios ",-1)),e("p",ge,[r(t(j),{class:"h-4 w-4 text-primary"}),s[1]||(s[1]=a(" Importa usuarios masivamente desde un archivo CSV o Excel ",-1))])]),e("div",xe,[e("div",be,[r(t(te),{class:"h-4 w-4 animate-pulse"}),s[3]||(s[3]=e("span",{class:"text-sm font-medium"},"Importación Masiva",-1))]),r(t(m),{variant:"outline","as-child":""},{default:o(()=>[r(t(B),{href:"/admin/users"},{default:o(()=>[r(t(re),{class:"mr-2 h-4 w-4"}),s[4]||(s[4]=a(" Volver a Usuarios ",-1))]),_:1})]),_:1})])]),C.value||I.value?(i(),c("div",ve,[C.value?(i(),x(t(E),{key:0,class:"border-green-200 bg-green-50"},{default:o(()=>[r(t(M),{class:"h-4 w-4 text-green-600"}),r(t(T),{class:"text-green-800"},{default:o(()=>[a(n(C.value),1)]),_:1})]),_:1})):p("",!0),I.value?(i(),x(t(E),{key:1,class:"border-red-200 bg-red-50"},{default:o(()=>[r(t(D),{class:"h-4 w-4 text-red-600"}),r(t(T),{class:"text-red-800"},{default:o(()=>[a(n(I.value),1)]),_:1})]),_:1})):p("",!0)])):p("",!0),e("div",_e,[r(t(_),{class:"border-border bg-card shadow-lg lg:col-span-2"},{default:o(()=>[r(t(y),{class:"border-b border-border bg-muted/50"},{default:o(()=>[r(t(h),{class:"flex items-center gap-2 text-foreground"},{default:o(()=>[r(t(V),{class:"h-5 w-5 text-primary"}),s[5]||(s[5]=a(" Subir Archivo ",-1))]),_:1}),r(t(F),{class:"text-muted-foreground"},{default:o(()=>[...s[6]||(s[6]=[a(" Selecciona un archivo CSV o Excel con la información de los usuarios ",-1)])]),_:1})]),_:1}),r(t(w),{class:"space-y-6 pt-6"},{default:o(()=>[e("div",ye,[r(t(K),{for:"import_file",class:"text-foreground"},{default:o(()=>[...s[7]||(s[7]=[a("Archivo de Importación *",-1)])]),_:1}),e("div",{class:"cursor-pointer rounded-lg border-2 border-dashed border-border p-6 text-center transition-colors hover:border-primary/50",onClick:A},[e("input",{id:"import_file",type:"file",accept:".csv,.xlsx,.xls",onChange:N,class:"hidden"},null,32),e("div",he,[r(t(V),{class:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),s[8]||(s[8]=e("p",{class:"mb-2 font-medium text-foreground"}," Haz clic para seleccionar un archivo ",-1)),s[9]||(s[9]=e("p",{class:"text-sm text-muted-foreground"}," Arrastra y suelta tu archivo aquí ",-1)),s[10]||(s[10]=e("p",{class:"mt-2 text-xs text-muted-foreground"}," Formatos soportados: CSV, Excel (.xlsx, .xls) ",-1)),s[11]||(s[11]=e("p",{class:"text-xs text-muted-foreground"}," Tamaño máximo: 10MB ",-1))])])]),u.value?(i(),c("div",we,[e("div",ke,[e("div",Ce,[r(t(oe),{class:"h-6 w-6 text-primary"})]),e("div",Ie,[e("p",Fe,n(u.value.name),1),e("div",Se,[e("span",null,n(O(u.value.size)),1),s[12]||(s[12]=e("span",null,"•",-1)),e("span",null,n(u.value.type||"Archivo"),1)])]),e("div",Be,[r(t(G),{variant:"outline",class:"border-blue-200 bg-blue-500/10 text-blue-600"},{default:o(()=>[...s[13]||(s[13]=[a(" Listo para importar ",-1)])]),_:1}),r(t(m),{variant:"ghost",size:"sm",onClick:P,class:"h-8 w-8 p-0"},{default:o(()=>[r(t(X),{class:"h-4 w-4"})]),_:1})])])])):p("",!0),r(t(m),{onClick:R,disabled:!u.value||f.value,class:"w-full bg-primary text-primary-foreground hover:bg-primary/90",size:"lg"},{default:o(()=>[f.value?(i(),x(t(ae),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(i(),x(t(V),{key:1,class:"mr-2 h-4 w-4"})),a(" "+n(f.value?"Procesando...":"Iniciar Importación"),1)]),_:1},8,["disabled"]),d.value?(i(),c("div",Ue,[e("div",{class:$(["rounded-lg border p-4",d.value.has_errors?"border-amber-200 bg-amber-50":"border-green-200 bg-green-50"])},[e("div",Me,[d.value.has_errors?(i(),x(t(D),{key:1,class:"h-5 w-5 text-amber-600"})):(i(),x(t(M),{key:0,class:"h-5 w-5 text-green-600"})),e("h3",{class:$(["font-semibold",d.value.has_errors?"text-amber-800":"text-green-800"])}," Resultado de la Importación ",2)]),e("div",De,[e("div",null,[s[14]||(s[14]=e("span",{class:"font-medium"},"Total de filas:",-1)),e("span",Ve,n(d.value.total_rows),1)]),e("div",null,[s[15]||(s[15]=e("span",{class:"font-medium"},"Importados:",-1)),e("span",Ee,n(d.value.imported),1)]),e("div",null,[s[16]||(s[16]=e("span",{class:"font-medium"},"Omitidos:",-1)),e("span",Te,n(d.value.skipped),1)])]),d.value.has_errors?(i(),c("div",$e,[e("div",ze,[s[18]||(s[18]=e("h4",{class:"font-medium text-amber-800"}," Errores encontrados: ",-1)),r(t(m),{variant:"outline",size:"sm",onClick:H,class:"text-xs"},{default:o(()=>[r(t(ce),{class:"mr-1 h-3 w-3"}),s[17]||(s[17]=a(" Descargar Reporte ",-1))]),_:1})]),e("div",je,[(i(!0),c(z,null,se(d.value.errors.slice(0,5),(g,v)=>(i(),c("div",{key:v,class:"rounded border border-amber-200 bg-white p-2 text-xs"},[e("div",Le," Fila "+n(Z(g.row))+" - "+n(g.field),1),e("div",Ae,n(g.error),1),e("div",Ne," Valor: "+n(g.value),1)]))),128)),d.value.errors.length>5?(i(),c("div",Pe," ... y "+n(d.value.errors.length-5)+" errores más ",1)):p("",!0)])])):p("",!0)],2),e("div",Re,[r(t(m),{variant:"outline",size:"sm",onClick:Y},{default:o(()=>[...s[19]||(s[19]=[a(" Limpiar Resultados ",-1)])]),_:1})])])):p("",!0)]),_:1})]),_:1}),e("div",qe,[r(t(_),{class:"border-border bg-card shadow-lg"},{default:o(()=>[r(t(y),{class:"border-b border-border bg-muted/50"},{default:o(()=>[r(t(h),{class:"text-foreground"},{default:o(()=>[...s[20]||(s[20]=[a("Plantilla",-1)])]),_:1}),r(t(F),{class:"text-muted-foreground"},{default:o(()=>[...s[21]||(s[21]=[a(" Descarga la plantilla oficial ",-1)])]),_:1})]),_:1}),r(t(w),{class:"pt-6"},{default:o(()=>[e("div",He,[e("div",Ye,[r(t(ie),{class:"h-8 w-8 text-primary"})]),s[23]||(s[23]=e("p",{class:"mb-4 text-sm text-muted-foreground"}," Usa nuestra plantilla predefinida para asegurar el formato correcto ",-1)),r(t(m),{variant:"outline",class:"w-full",onClick:q},{default:o(()=>[r(t(ne),{class:"mr-2 h-4 w-4"}),s[22]||(s[22]=a(" Descargar Plantilla CSV ",-1))]),_:1})])]),_:1})]),_:1}),r(t(_),{class:"border-border bg-card shadow-lg"},{default:o(()=>[r(t(y),{class:"border-b border-border bg-muted/50"},{default:o(()=>[r(t(h),{class:"text-foreground"},{default:o(()=>[...s[24]||(s[24]=[a("Formato Requerido",-1)])]),_:1})]),_:1}),r(t(w),{class:"pt-6"},{default:o(()=>[e("div",Oe,[e("div",null,[e("h4",Ze,[r(t(M),{class:"h-4 w-4 text-green-500"}),s[25]||(s[25]=a(" Columnas Obligatorias ",-1))]),s[26]||(s[26]=e("ul",{class:"space-y-2 text-sm text-muted-foreground"},[e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"name"),a(" (Nombre)")])]),e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"last_name"),a(" (Apellido)")])]),e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"email"),a(" (Email único)")])]),e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"dni"),a(" (DNI - 8 dígitos)")])]),e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"phone"),a(" (Teléfono - 9 dígitos)")])]),e("li",{class:"flex items-center gap-2"},[e("div",{class:"h-1.5 w-1.5 rounded-full bg-primary"}),e("span",null,[e("strong",null,"user_type"),a(" (student/teacher/external/staff)")])])],-1))]),e("div",Ge,[e("h4",Ke,[r(t(D),{class:"h-4 w-4 text-amber-500"}),s[27]||(s[27]=a(" Consideraciones ",-1))]),s[28]||(s[28]=e("ul",{class:"space-y-1 text-xs text-muted-foreground"},[e("li",null," • Las contraseñas se generan automáticamente "),e("li",null," • Los usuarios reciben email de verificación "),e("li",null," • Se asignan permisos según el tipo de usuario "),e("li",null," • El sistema valida duplicados automáticamente "),e("li",null,"• Fechas en formato YYYY-MM-DD"),e("li",null," • Booleanos: 1/0, true/false, yes/no ")],-1))])])]),_:1})]),_:1})])]),r(t(_),{class:"border-border bg-card shadow-lg"},{default:o(()=>[r(t(y),{class:"border-b border-border bg-muted/50"},{default:o(()=>[r(t(h),{class:"flex items-center gap-2 text-foreground"},{default:o(()=>[r(t(de),{class:"h-5 w-5 text-primary"}),s[29]||(s[29]=a(" Procesos de Importación ",-1))]),_:1}),r(t(F),{class:"text-muted-foreground"},{default:o(()=>[...s[30]||(s[30]=[a(" Historial y estado de importaciones recientes ",-1)])]),_:1})]),_:1}),r(t(w),{class:"pt-6"},{default:o(()=>[e("div",Xe,[e("div",Je,[e("div",Qe,[r(t(ue),{class:"h-10 w-10 text-primary"})]),s[33]||(s[33]=e("h3",{class:"mb-3 text-2xl font-bold text-foreground"}," No hay importaciones recientes ",-1)),s[34]||(s[34]=e("p",{class:"mb-6 text-lg text-muted-foreground"}," Comienza importando tu primer lote de usuarios ",-1)),e("div",We,[r(t(m),{variant:"outline","as-child":"",class:"border-primary/20 text-primary hover:bg-primary hover:text-primary-foreground"},{default:o(()=>[r(t(B),{href:"/admin/users/create"},{default:o(()=>[r(t(me),{class:"mr-2 h-4 w-4"}),s[31]||(s[31]=a(" Crear Usuario Manual ",-1))]),_:1})]),_:1}),r(t(m),{"as-child":"",class:"bg-primary text-primary-foreground hover:bg-primary/90"},{default:o(()=>[r(t(B),{href:"/admin/users"},{default:o(()=>[r(t(j),{class:"mr-2 h-4 w-4"}),s[32]||(s[32]=a(" Ver Todos los Usuarios ",-1))]),_:1})]),_:1})])])])]),_:1})]),_:1})])]),_:1})],64))}});export{zs as default};
